{
  Objects.requireNonNull(highlightPattern);
  String searchText=Objects.requireNonNull(text);
  if (searchText.isEmpty() || !highlightPattern.isPresent()) {
    return searchText;
  }
  Matcher matcher=highlightPattern.get().matcher(searchText);
  StringBuffer sb=new StringBuffer();
  boolean foundSomething=false;
  while (matcher.find()) {
    String found=matcher.group();
    matcher.appendReplacement(sb,"<span style=\"background-color:" + HIGHLIGHT_COLOR + ";\">"+ found+ "</span>");
    foundSomething=true;
  }
  if (foundSomething) {
    matcher.appendTail(sb);
    searchText=sb.toString();
  }
  return searchText;
}
