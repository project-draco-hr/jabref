{
  try {
    JComponent focused=Globals.focusListener.getFocused();
    if (focused != null && focused instanceof FieldEditor && focused.hasFocus()) {
      if (preambleEditor != null && focused == preambleEditor.getFieldEditor()) {
        preambleEditor.storeCurrentEdit();
      }
 else {
        storeCurrentEdit();
      }
    }
    String name=undoManager.getUndoPresentationName();
    undoManager.undo();
    markBaseChanged();
    frame.output(name);
  }
 catch (  CannotUndoException ex) {
    ex.printStackTrace();
    frame.output(Globals.lang("Nothing to undo") + '.');
  }
  markChangedOrUnChanged();
}
