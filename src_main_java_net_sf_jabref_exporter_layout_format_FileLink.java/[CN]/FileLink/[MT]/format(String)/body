{
  if (field == null) {
    return "";
  }
  List<ParsedFileField> fileList=FileField.parse(field);
  String link=null;
  if (fileType == null) {
    if (!(fileList.isEmpty())) {
      link=fileList.get(0).link;
    }
  }
 else {
    for (    ParsedFileField flEntry : fileList) {
      if (flEntry.fileType.equalsIgnoreCase(fileType)) {
        link=flEntry.link;
        break;
      }
    }
  }
  if (link == null) {
    return "";
  }
  String[] dirs;
  if (Globals.prefs.fileDirForDatabase == null) {
    dirs=new String[]{Globals.prefs.get(Globals.FILE_FIELD + Globals.DIR_SUFFIX)};
  }
 else {
    dirs=Globals.prefs.fileDirForDatabase;
  }
  File f=FileUtil.expandFilename(link,Arrays.asList(dirs));
  if (f == null) {
    return link;
  }
 else {
    try {
      return f.getCanonicalPath();
    }
 catch (    IOException e) {
      LOGGER.warn("Problem getting path",e);
      return f.getPath();
    }
  }
}
