{
  String[] words=input.split("\\s+");
  String[] result=new String[words.length];
  for (int i=0; i < words.length; i++) {
    if (words[i].startsWith("{")) {
      result[i]=words[i];
    }
 else {
      String word=words[i].toLowerCase();
      boolean alwaysCapitalizeFirstWord=i == 0;
      boolean alwaysCapitalizeLastWord=i == (words.length - 1);
      if (alwaysCapitalizeFirstWord || alwaysCapitalizeLastWord) {
        result[i]=StringUtil.capitalizeFirst(word);
      }
 else       if (TitleCaseChanger.notToCapitalize.contains(word)) {
        result[i]=word;
      }
 else {
        result[i]=StringUtil.capitalizeFirst(word);
      }
    }
  }
  return StringUtil.join(result,CaseChangers.SPACE_SEPARATOR);
}
