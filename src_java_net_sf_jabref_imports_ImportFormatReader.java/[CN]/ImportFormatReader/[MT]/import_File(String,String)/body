{
  BibtexDatabase database=null;
  List<BibtexEntry> bibentries=null;
  File f=new File(filename);
  if (!f.exists())   throw new IOException(Globals.lang("File not found") + ": " + filename);
  try {
    bibentries=Globals.importFormatReader.importFromFile(format,filename);
  }
 catch (  IllegalArgumentException ex) {
    throw new IOException(Globals.lang("Could not resolve import format") + " '" + format+ "'");
  }
  if (bibentries == null)   throw new IOException(Globals.lang("Import failed"));
  purgeEmptyEntries(bibentries);
  database=new BibtexDatabase();
  Iterator<BibtexEntry> it=bibentries.iterator();
  while (it.hasNext()) {
    BibtexEntry entry=it.next();
    try {
      entry.setId(Util.createNeutralId());
      database.insertEntry(entry);
    }
 catch (    KeyCollisionException ex) {
      System.err.println("KeyCollisionException [ addBibEntries(...) ]");
    }
  }
  return database;
}
