{
  Object entryList=null;
  String usedFormat=null;
  int bestResult=0;
  for (Iterator i=getImportFormats().iterator(); i.hasNext(); ) {
    ImportFormat imFo=(ImportFormat)((Map.Entry)i.next()).getValue();
    try {
      List entries=importFromFile(imFo,filename);
      if (entries != null)       purgeEmptyEntries(entries);
      int entryCount=((entries != null) ? entries.size() : 0);
      if (entryCount > bestResult) {
        bestResult=entryCount;
        usedFormat=imFo.getFormatName();
        entryList=entries;
      }
    }
 catch (    IOException ex) {
    }
  }
  if (entryList == null) {
    try {
      ParserResult pr=loadDatabase(new File(filename),Globals.prefs.get("defaultEncoding"));
      if ((pr.getDatabase().getEntryCount() > 0) || (pr.getDatabase().getStringCount() > 0)) {
        entryList=pr;
        pr.setFile(new File(filename));
        usedFormat=BIBTEX_FORMAT;
      }
    }
 catch (    Throwable ex) {
    }
  }
  return new Object[]{usedFormat,entryList};
}
