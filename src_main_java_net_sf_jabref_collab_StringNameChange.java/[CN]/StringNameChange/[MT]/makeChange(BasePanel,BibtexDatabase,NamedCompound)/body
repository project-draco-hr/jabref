{
  if (panel.database().hasStringLabel(disk)) {
    Globals.logger("Cannot rename string '" + mem + "' to '"+ disk+ "' because the name "+ "is already in use.");
  }
  if (string != null) {
    string.setName(disk);
    undoEdit.addEdit(new UndoableStringChange(panel,string,true,mem,disk));
  }
 else {
    String newId=IdGenerator.next();
    BibtexString bs=new BibtexString(newId,disk,content);
    try {
      panel.database().addString(bs);
      undoEdit.addEdit(new UndoableInsertString(panel,panel.database(),bs));
    }
 catch (    KeyCollisionException ex) {
      Globals.logger("Error: could not add string '" + bs.getName() + "': "+ ex.getMessage());
    }
  }
  if (tmpString != null) {
    tmpString.setName(disk);
  }
 else {
    String newId=IdGenerator.next();
    BibtexString bs=new BibtexString(newId,disk,content);
    secondary.addString(bs);
  }
  return true;
}
