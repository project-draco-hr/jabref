{
  if (bibDatabaseContext.getMetaData() == null) {
    List<BibEntry> result=new LinkedList<>();
    if (entriesToSort == null) {
      result.addAll(bibDatabaseContext.getDatabase().getEntries());
    }
 else {
      result.addAll(entriesToSort);
    }
    return result;
  }
  List<Comparator<BibEntry>> comparators=BibDatabaseWriter.getSaveComparators(preferences,bibDatabaseContext.getMetaData());
  FieldComparatorStack<BibEntry> comparatorStack=new FieldComparatorStack<>(comparators);
  List<BibEntry> sorted=new ArrayList<>();
  if (entriesToSort == null) {
    sorted.addAll(bibDatabaseContext.getDatabase().getEntries());
  }
 else {
    sorted.addAll(entriesToSort);
  }
  Collections.sort(sorted,comparatorStack);
  return sorted;
}
