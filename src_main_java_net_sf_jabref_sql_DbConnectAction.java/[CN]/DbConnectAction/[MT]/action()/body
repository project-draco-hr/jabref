{
  DBStrings dbs=panel.metaData().getDBStrings();
  if (!dbs.isInitialized()) {
    dbs.initialize();
  }
  DBConnectDialog dbd=new DBConnectDialog(panel.frame(),dbs);
  Util.placeDialog(dbd,panel);
  dbd.setVisible(true);
  if (dbd.getConnectToDB()) {
    dbs=dbd.getDBStrings();
    try {
      panel.frame().output(Localization.lang("Establishing SQL connection..."));
      DBExporter exporter=(new DBExporterAndImporterFactory()).getExporter(dbs.getServerType());
      Connection conn=exporter.connectToDB(dbs);
      conn.close();
      dbs.isConfigValid(true);
      panel.frame().output(Localization.lang("SQL connection established."));
    }
 catch (    Exception ex) {
      String errorMessage=SQLUtil.getExceptionMessage(ex);
      dbs.isConfigValid(false);
      String preamble="Could not connect to SQL database for the following reason:";
      panel.frame().output(Localization.lang(preamble) + "  " + errorMessage);
      JOptionPane.showMessageDialog(panel.frame(),Localization.lang(preamble) + '\n' + errorMessage,Localization.lang("Connect to SQL database"),JOptionPane.ERROR_MESSAGE);
    }
 finally {
      panel.metaData().setDBStrings(dbs);
      dbd.dispose();
    }
  }
}
