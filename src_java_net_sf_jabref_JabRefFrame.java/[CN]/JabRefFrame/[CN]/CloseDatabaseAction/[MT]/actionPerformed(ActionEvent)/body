{
  boolean close=true;
  if (basePanel() == null) {
    return;
  }
  if (basePanel().baseChanged) {
    int answer=JOptionPane.showConfirmDialog(JabRefFrame.this,Globals.lang("Database has changed. Do you want to save " + "before closing?"),Globals.lang("Save before closing"),JOptionPane.YES_NO_CANCEL_OPTION);
    if ((answer == JOptionPane.CANCEL_OPTION) || (answer == JOptionPane.CLOSED_OPTION)) {
      close=false;
    }
    if (answer == JOptionPane.YES_OPTION) {
      try {
        SaveDatabaseAction saveAction=new SaveDatabaseAction(basePanel());
        saveAction.runCommand();
        if (saveAction.isCancelled() || !saveAction.isSuccess())         close=false;
      }
 catch (      Throwable ex) {
        close=false;
      }
    }
  }
  if (close) {
    close();
  }
}
