{
  Vector filenames=new Vector();
  if (tabbedPane.getTabCount() > 0) {
    for (int i=0; i < tabbedPane.getTabCount(); i++) {
      if (tabbedPane.getTitleAt(i).equals(GUIGlobals.untitledTitle)) {
        tabbedPane.setSelectedIndex(i);
        int answer=JOptionPane.showConfirmDialog(ths,Globals.lang("This untitled database must be saved first to be " + "included in the saved session. Save now?"),Globals.lang("Save database"),JOptionPane.YES_NO_OPTION);
        if (answer == JOptionPane.YES_OPTION) {
          basePanel().runCommand("save");
        }
      }
      if (baseAt(i).file != null)       filenames.add(baseAt(i).file.getPath());
    }
  }
  if (filenames.size() == 0) {
    output(Globals.lang("Not saved (empty session)") + ".");
    return;
  }
 else {
    String[] names=new String[filenames.size()];
    for (int i=0; i < filenames.size(); i++)     names[i]=(String)filenames.elementAt(i);
    prefs.putStringArray("savedSession",names);
    output(Globals.lang("Saved session") + ".");
  }
}
