{
  if ((fileToOpen != null) && (fileToOpen.exists())) {
    try {
      prefs.put("workingDirectory",fileToOpen.getPath());
      ParserResult pr=loadDatabase(fileToOpen);
      BibtexDatabase db=pr.getDatabase();
      HashMap meta=pr.getMetaData();
      BasePanel bp=new BasePanel(ths,db,fileToOpen,meta,prefs);
      tabbedPane.add(fileToOpen.getName(),bp);
      if (raisePanel) {
        tabbedPane.setSelectedComponent(bp);
      }
      if (tabbedPane.getTabCount() == 1) {
        setNonEmptyState();
      }
      output(Globals.lang("Opened database") + " '" + fileToOpen.getPath()+ "' "+ Globals.lang("with")+ " "+ db.getEntryCount()+ " "+ Globals.lang("entries")+ ".");
      fileToOpen=null;
    }
 catch (    Throwable ex) {
      JOptionPane.showMessageDialog(ths,ex.getMessage(),Globals.lang("Open database"),JOptionPane.ERROR_MESSAGE);
    }
  }
}
