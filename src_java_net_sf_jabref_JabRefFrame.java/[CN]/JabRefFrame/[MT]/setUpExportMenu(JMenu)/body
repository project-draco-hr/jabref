{
  ActionListener listener=new ActionListener(){
    public void actionPerformed(    ActionEvent e){
      JMenuItem source=(JMenuItem)e.getSource();
      String lfFileName=null, extension=null;
      if (source == htmlItem) {
        lfFileName="html";
        extension=".html";
      }
 else       if (source == simpleHtmlItem) {
        lfFileName="simplehtml";
        extension=".html";
      }
 else       if (source == docbookItem) {
        lfFileName="docbook";
        extension=".xml";
      }
 else       if (source == bibtexmlItem) {
        lfFileName="bibtexml";
        extension=".xml";
      }
 else       if (source == modsItem) {
        lfFileName="mods";
        extension=".xml";
      }
 else       if (source == rtfItem) {
        lfFileName="harvard";
        extension=".rtf";
      }
 else       if (source == endnoteItem) {
        lfFileName="endnote";
        extension=".txt";
      }
 else       if (source == openofficeItem) {
        lfFileName="oocalc";
        extension=".sxc";
      }
 else       if (source == odsItem) {
        lfFileName="ods";
        extension=".ods";
      }
      final String chosenFile=Globals.getNewFile(ths,prefs,new File(prefs.get("workingDirectory")),extension,JFileChooser.SAVE_DIALOG,false);
      final String exportName=lfFileName;
      if (chosenFile == null)       return;
      (new Thread(){
        public void run(){
          try {
            FileActions.performExport(basePanel().database(),exportName,chosenFile,basePanel().getEncoding());
            output(Globals.lang("Exported database to file") + " '" + chosenFile+ "'.");
          }
 catch (          Exception ex) {
            ex.printStackTrace();
          }
        }
      }
).start();
    }
  }
;
  htmlItem.addActionListener(listener);
  menu.add(htmlItem);
  simpleHtmlItem.addActionListener(listener);
  menu.add(simpleHtmlItem);
  bibtexmlItem.addActionListener(listener);
  menu.add(bibtexmlItem);
  docbookItem.addActionListener(listener);
  menu.add(docbookItem);
  modsItem.addActionListener(listener);
  menu.add(modsItem);
  rtfItem.addActionListener(listener);
  menu.add(rtfItem);
  endnoteItem.addActionListener(listener);
  menu.add(endnoteItem);
  openofficeItem.addActionListener(listener);
  odsItem.addActionListener(listener);
  menu.add(openofficeItem);
  menu.add(odsItem);
  menu.add(exportCSV);
  menu.addSeparator();
  menu.add(expandEndnoteZip);
}
