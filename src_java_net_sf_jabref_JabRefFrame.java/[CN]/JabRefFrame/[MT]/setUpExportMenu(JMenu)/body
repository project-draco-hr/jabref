{
  ActionListener listener=new ActionListener(){
    public void actionPerformed(    ActionEvent e){
      JMenuItem source=(JMenuItem)e.getSource();
      String lfFileName=null, extension=null;
      if (source == htmlItem) {
        lfFileName="html";
        extension=".html";
      }
      if (source == simpleHtmlItem) {
        lfFileName="simplehtml";
        extension=".html";
      }
 else       if (source == docbookItem) {
        lfFileName="docbook";
        extension=".xml";
      }
 else       if (source == bibtexmlItem) {
        lfFileName="bibtexml";
        extension=".xml";
      }
      File outFile=null;
      String chosenFile=Globals.getNewFile(ths,prefs,new File(prefs.get("workingDirectory")),extension,JFileChooser.SAVE_DIALOG,false);
      if (chosenFile != null)       outFile=new File(chosenFile);
 else {
        return;
      }
      final String lfName=lfFileName;
      final File oFile=outFile;
      (new Thread(){
        public void run(){
          try {
            FileActions.exportDatabase(basePanel().database,lfName,oFile,prefs);
            output(Globals.lang("Exported database to file") + " '" + oFile.getPath()+ "'.");
          }
 catch (          Exception ex) {
            ex.printStackTrace();
          }
        }
      }
).start();
    }
  }
;
  JMenuItem item;
  htmlItem.addActionListener(listener);
  menu.add(htmlItem);
  simpleHtmlItem.addActionListener(listener);
  menu.add(simpleHtmlItem);
  bibtexmlItem.addActionListener(listener);
  menu.add(bibtexmlItem);
  docbookItem.addActionListener(listener);
  menu.add(docbookItem);
  menu.add(exportCSV);
}
