{
  macOSXRegistration();
  setTitle(GUIGlobals.frameTitle);
  setIconImage(new ImageIcon(GUIGlobals.jabreflogo).getImage());
  setDefaultCloseOperation(WindowConstants.DO_NOTHING_ON_CLOSE);
  addWindowListener(new WindowAdapter(){
    public void windowClosing(    WindowEvent e){
      (new CloseAction()).actionPerformed(null);
    }
  }
);
  initLabelMaker();
  setupLayout();
  setSize(new Dimension(prefs.getInt("sizeX"),prefs.getInt("sizeY")));
  setLocation(new Point(prefs.getInt("posX"),prefs.getInt("posY")));
  tabbedPane.addChangeListener(new ChangeListener(){
    private int lastSelectionIndex=-1;
    public void stateChanged(    ChangeEvent e){
      int now=tabbedPane.getSelectedIndex();
      if (lastSelectionIndex > -1)       tabbedPane.setForegroundAt(lastSelectionIndex,GUIGlobals.inActiveTabbed);
      if (now > -1)       tabbedPane.setForegroundAt(now,GUIGlobals.activeTabbed);
      lastSelectionIndex=now;
      BasePanel bp=basePanel();
      if (bp != null) {
        groupToggle.setSelected(bp.sidePaneManager.isPanelVisible("groups"));
        searchToggle.setSelected(bp.sidePaneManager.isPanelVisible("search"));
        previewToggle.setSelected(bp.previewEnabled);
        Globals.focusListener.setFocused(bp.entryTable);
        new FocusRequester(bp.entryTable);
      }
    }
  }
);
}
