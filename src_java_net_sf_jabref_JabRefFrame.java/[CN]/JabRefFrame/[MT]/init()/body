{
  macOSXRegistration();
  setGlassPane(new MyGlassPane());
  setTitle(GUIGlobals.frameTitle);
  setIconImage(new ImageIcon(GUIGlobals.jabreflogo).getImage());
  setDefaultCloseOperation(WindowConstants.DO_NOTHING_ON_CLOSE);
  addWindowListener(new WindowAdapter(){
    public void windowClosing(    WindowEvent e){
      (new CloseAction()).actionPerformed(null);
    }
  }
);
  initLabelMaker();
  sidePaneManager=new SidePaneManager(this);
  Globals.sidePaneManager=this.sidePaneManager;
  Globals.helpDiag=this.helpDiag;
  medlineFetcher=new MedlineFetcher(sidePaneManager);
  citeSeerFetcher=new CiteSeerFetcher(sidePaneManager);
  citeSeerFetcherPanel=new CiteSeerFetcherPanel(sidePaneManager,(CiteSeerFetcher)citeSeerFetcher);
  searchManager=new SearchManager2(this,sidePaneManager);
{
    groupSelector=new GroupSelector(this,sidePaneManager);
    sidePaneManager.register("groups",groupSelector);
  }
  sidePaneManager.register("fetchMedline",medlineFetcher);
  sidePaneManager.register("search",searchManager);
  if (Globals.prefs.getBoolean("searchPanelVisible"))   sidePaneManager.ensureVisible("search");
  sidePaneManager.register("CiteSeerPanel",citeSeerFetcherPanel);
  sidePaneManager.register("CiteSeerProgress",citeSeerFetcher);
  sidePaneManager.populatePanel();
  setupLayout();
  setSize(new Dimension(prefs.getInt("sizeX"),prefs.getInt("sizeY")));
  setLocation(new Point(prefs.getInt("posX"),prefs.getInt("posY")));
  tabbedPane.setBorder(null);
  tabbedPane.setForeground(GUIGlobals.inActiveTabbed);
  tabbedPane.addChangeListener(new ChangeListener(){
    public void stateChanged(    ChangeEvent e){
      markActiveBasePanel();
      BasePanel bp=basePanel();
      if (bp != null) {
        groupToggle.setSelected(sidePaneManager.isPanelVisible("groups"));
        searchToggle.setSelected(sidePaneManager.isPanelVisible("search"));
        previewToggle.setSelected(Globals.prefs.getBoolean("previewEnabled"));
        highlightAny.setSelected(Globals.prefs.getBoolean("highlightGroupsMatchingAny"));
        highlightAll.setSelected(Globals.prefs.getBoolean("highlightGroupsMatchingAll"));
        Globals.focusListener.setFocused(bp.entryTable);
        new FocusRequester(bp.entryTable);
      }
    }
  }
);
}
