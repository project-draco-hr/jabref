{
  try {
    String lookFeel;
    String systemLnF=UIManager.getSystemLookAndFeelClassName();
    if (Globals.prefs.getBoolean("useDefaultLookAndFeel")) {
      lookFeel=systemLnF;
    }
 else {
      lookFeel=Globals.prefs.get("lookAndFeel");
    }
    if (lookFeel.equals("javax.swing.plaf.metal.MetalLookAndFeel")) {
      Plastic3DLookAndFeel lnf=new Plastic3DLookAndFeel();
      Plastic3DLookAndFeel.setCurrentTheme(new SkyBluer());
      com.jgoodies.looks.Options.setPopupDropShadowEnabled(true);
      UIManager.setLookAndFeel(lnf);
    }
 else {
      try {
        UIManager.setLookAndFeel(lookFeel);
      }
 catch (      Exception e) {
        UIManager.setLookAndFeel(systemLnF);
        Globals.prefs.put("lookAndFeel",systemLnF);
        JOptionPane.showMessageDialog(JabRef.jrf,Globals.lang("Unable to find the requested Look & Feel and thus the default one is used."),Globals.lang("Warning"),JOptionPane.WARNING_MESSAGE);
      }
    }
  }
 catch (  Exception e) {
    e.printStackTrace();
  }
  boolean overrideDefaultFonts=Globals.prefs.getBoolean("overrideDefaultFonts");
  if (overrideDefaultFonts) {
    int fontSize=Globals.prefs.getInt("menuFontSize");
    UIDefaults defaults=UIManager.getDefaults();
    Enumeration<Object> keys=defaults.keys();
    Double zoomLevel=null;
    while (keys.hasMoreElements()) {
      Object key=keys.nextElement();
      if ((key instanceof String) && (((String)key).endsWith(".font"))) {
        FontUIResource font=(FontUIResource)UIManager.get(key);
        if (zoomLevel == null) {
          zoomLevel=(double)fontSize / (double)font.getSize();
        }
        font=new FontUIResource(font.getName(),font.getStyle(),fontSize);
        defaults.put(key,font);
      }
    }
    if (zoomLevel != null) {
      GUIGlobals.zoomLevel=zoomLevel;
    }
  }
}
