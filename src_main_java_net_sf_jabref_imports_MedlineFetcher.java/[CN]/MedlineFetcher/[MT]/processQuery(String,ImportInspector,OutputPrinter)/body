{
  shouldContinue=true;
  query=query.trim().replace(';',',');
  if (query.matches("\\d+[,\\d+]*")) {
    frame.setStatus(Globals.lang("Fetching Medline by id..."));
    List<BibtexEntry> bibs=MedlineImporter.fetchMedline(query,frame);
    if (bibs.isEmpty()) {
      frame.showMessage(Globals.lang("No references found"));
    }
    for (    BibtexEntry entry : bibs) {
      dialog.addEntry(entry);
    }
    return true;
  }
  if (!query.isEmpty()) {
    frame.setStatus(Globals.lang("Fetching Medline by term..."));
    String searchTerm=toSearchTerm(query);
    SearchResult result=getIds(searchTerm,0,1);
    if (result.count == 0) {
      frame.showMessage(Globals.lang("No references found"));
      return false;
    }
    int numberToFetch=result.count;
    if (numberToFetch > MedlineFetcher.PACING) {
      while (true) {
        String strCount=JOptionPane.showInputDialog(Globals.lang("References found") + ": " + numberToFetch+ "  "+ Globals.lang("Number of references to fetch?"),Integer.toString(numberToFetch));
        if (strCount == null) {
          frame.setStatus(Globals.lang("Medline import canceled"));
          return false;
        }
        try {
          numberToFetch=Integer.parseInt(strCount.trim());
          break;
        }
 catch (        RuntimeException ex) {
          frame.showMessage(Globals.lang("Please enter a valid number"));
        }
      }
    }
    for (int i=0; i < numberToFetch; i+=MedlineFetcher.PACING) {
      if (!shouldContinue) {
        break;
      }
      int noToFetch=Math.min(MedlineFetcher.PACING,numberToFetch - i);
      result=getIds(searchTerm,i,noToFetch);
      List<BibtexEntry> bibs=MedlineImporter.fetchMedline(result.ids,frame);
      for (      BibtexEntry entry : bibs) {
        dialog.addEntry(entry);
      }
      dialog.setProgress(i + noToFetch,numberToFetch);
    }
    return true;
  }
  frame.showMessage(Globals.lang("Please enter a comma separated list of Medline IDs (numbers) or search terms."),Globals.lang("Input error"),JOptionPane.ERROR_MESSAGE);
  return false;
}
