{
  int longestFound=-1;
  ExternalFileType foundType=null;
  for (  ExternalFileType type : externalFileTypes) {
    if (type.getExtension() != null && filename.toLowerCase().endsWith(type.getExtension().toLowerCase())) {
      if (type.getExtension().length() > longestFound) {
        longestFound=type.getExtension().length();
        foundType=type;
      }
    }
  }
  return foundType;
}
