{
  try {
    bibDatabaseContext.getDBSynchronizer().openSharedDatabase(connectionProperties);
    frame.addTab(bibDatabaseContext,true);
    setGlobalPrefs();
    bibDatabaseContext.getDBSynchronizer().registerListener(new SharedDatabaseUIManager(frame));
    frame.output(Localization.lang("Connection_to_%0_server_stablished.",connectionProperties.getType().toString()));
    dispose();
  }
 catch (  ClassNotFoundException exception) {
    JOptionPane.showMessageDialog(OpenSharedDatabaseDialog.this,exception.getMessage(),Localization.lang("Driver error"),JOptionPane.ERROR_MESSAGE);
  }
catch (  SQLException exception) {
    JOptionPane.showMessageDialog(OpenSharedDatabaseDialog.this,exception.getMessage(),Localization.lang("Connection error"),JOptionPane.ERROR_MESSAGE);
  }
catch (  DatabaseNotSupportedException exception) {
    new MigrationHelpDialog(this).setVisible(true);
  }
}
