{
  OOCalcDatabase od=new OOCalcDatabase(database,keySet);
  try {
    try (Writer ps=new OutputStreamWriter(new FileOutputStream(tmpFile),"UTF8")){
      DOMSource source=new DOMSource(od.getDOMrepresentation());
      StreamResult result=new StreamResult(ps);
      Transformer trans=TransformerFactory.newInstance().newTransformer();
      trans.setOutputProperty(OutputKeys.INDENT,"yes");
      trans.transform(source,result);
    }
   }
 catch (  Exception e) {
    throw new Error(e);
  }
}
