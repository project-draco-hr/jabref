{
  ok.addActionListener(new ActionListener(){
    @Override public void actionPerformed(    ActionEvent e){
      storeSettings();
      dispose();
    }
  }
);
  AbstractAction cancelAction=new AbstractAction(){
    private static final long serialVersionUID=-4147450749465768880L;
    @Override public void actionPerformed(    ActionEvent e){
      dispose();
    }
  }
;
  cancel.addActionListener(cancelAction);
  toDefaults.addActionListener(new ActionListener(){
    @Override public void actionPerformed(    ActionEvent e){
      java.util.List<ExternalFileType> list=Globals.prefs.getDefaultExternalFileTypes();
      fileTypes.clear();
      fileTypes.addAll(list);
      Collections.sort(fileTypes);
      tableModel.fireTableDataChanged();
    }
  }
);
  add.addActionListener(new AddListener());
  remove.addActionListener(new RemoveListener());
  edit.addActionListener(editListener);
  fileTypes=new ArrayList<ExternalFileType>();
  setValues();
  tableModel=new FileTypeTableModel();
  table=new JTable(tableModel);
  table.setDefaultRenderer(ImageIcon.class,new IconRenderer());
  table.addMouseListener(new TableClickListener());
  table.getColumnModel().getColumn(0).setMaxWidth(24);
  table.getColumnModel().getColumn(0).setMinWidth(24);
  table.getColumnModel().getColumn(1).setMinWidth(170);
  table.getColumnModel().getColumn(2).setMinWidth(60);
  table.getColumnModel().getColumn(3).setMinWidth(100);
  table.getColumnModel().getColumn(0).setResizable(false);
  JScrollPane sp=new JScrollPane(table);
  JPanel upper=new JPanel();
  upper.setLayout(new BorderLayout());
  upper.setBorder(BorderFactory.createEmptyBorder(5,5,5,5));
  upper.add(sp,BorderLayout.CENTER);
  getContentPane().add(upper,BorderLayout.CENTER);
  ButtonStackBuilder bs=new ButtonStackBuilder();
  bs.addButton(add);
  bs.addButton(remove);
  bs.addButton(edit);
  bs.addRelatedGap();
  bs.addButton(toDefaults);
  upper.add(bs.getPanel(),BorderLayout.EAST);
  ButtonBarBuilder bb=new ButtonBarBuilder();
  bb.addGlue();
  bb.addButton(ok);
  bb.addButton(cancel);
  bb.addGlue();
  bb.getPanel().setBorder(BorderFactory.createEmptyBorder(5,5,5,5));
  getContentPane().add(bb.getPanel(),BorderLayout.SOUTH);
  pack();
  ActionMap am=upper.getActionMap();
  InputMap im=upper.getInputMap(JComponent.WHEN_IN_FOCUSED_WINDOW);
  im.put(Globals.prefs.getKey("Close dialog"),"close");
  am.put("close",cancelAction);
  am=bb.getPanel().getActionMap();
  im=bb.getPanel().getInputMap(JComponent.WHEN_IN_FOCUSED_WINDOW);
  im.put(Globals.prefs.getKey("Close dialog"),"close");
  am.put("close",cancelAction);
  if (frame != null) {
    setLocationRelativeTo(frame);
  }
 else {
    setLocationRelativeTo(dialog);
  }
}
