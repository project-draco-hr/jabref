{
  ArrayList<BibEntry> entries=new ArrayList<>();
  Collections.addAll(entries,JabRef.jrf.getCurrentBasePanel().getSelectedEntries());
  if (entries.isEmpty()) {
    JabRef.jrf.getCurrentBasePanel().output(Localization.lang("No entries selected."));
    return;
  }
  JDialog diag=new JDialog(JabRef.jrf,true);
  final NamedCompound nc=new NamedCompound(Localization.lang("Automatically set file links"));
  Runnable runnable=Util.autoSetLinks(entries,nc,null,null,JabRef.jrf.getCurrentBasePanel().loadedDatabase.getMetaData(),new ActionListener(){
    @Override public void actionPerformed(    ActionEvent e){
      if (e.getID() > 0) {
        if (nc.hasEdits()) {
          nc.end();
          JabRef.jrf.getCurrentBasePanel().undoManager.addEdit(nc);
          JabRef.jrf.getCurrentBasePanel().markBaseChanged();
        }
        JabRef.jrf.output(Localization.lang("Finished autosetting external links."));
      }
 else {
        JabRef.jrf.output(Localization.lang("Finished autosetting external links.") + " " + Localization.lang("No files found."));
      }
    }
  }
,diag);
  JabRefExecutorService.INSTANCE.execute(runnable);
}
