{
  try {
    while (!Thread.interrupted()) {
      try {
        Socket socket=serverSocket.accept();
        socket.setSoTimeout(1000);
        if (Thread.interrupted()) {
          return;
        }
        Protocol protocol=new Protocol(socket);
        protocol.sendMessage(IDENTIFIER);
        try {
          String message=protocol.receiveMessage();
          if (message.isEmpty()) {
            continue;
          }
          Vector<ParserResult> loaded=jabref.processArguments(message.split("\n"),false);
          if (loaded == null) {
            return;
          }
          SwingUtilities.invokeLater(new Runnable(){
            @Override public void run(){
              JabRef.jrf.showIfMinimizedToSysTray();
            }
          }
);
          for (int i=0; i < loaded.size(); i++) {
            ParserResult pr=loaded.elementAt(i);
            JabRef.jrf.addParserResult(pr,(i == 0));
          }
        }
  finally {
          protocol.close();
        }
      }
 catch (      SocketException ex) {
        return;
      }
catch (      IOException e) {
        e.printStackTrace();
      }
    }
  }
  finally {
    closeServerSocket();
  }
}
