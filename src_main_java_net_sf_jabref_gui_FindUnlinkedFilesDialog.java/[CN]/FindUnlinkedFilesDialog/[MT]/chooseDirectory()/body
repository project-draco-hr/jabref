{
  if (fileChooser == null) {
    fileChooser=new JFileChooser();
    fileChooser.setAutoscrolls(true);
    fileChooser.setDialogTitle(Localization.lang("Select directory"));
    fileChooser.setApproveButtonText(Localization.lang("Choose Directory"));
    fileChooser.setApproveButtonToolTipText(Localization.lang("Use the selected directory to start with the search."));
    fileChooser.setFileSelectionMode(JFileChooser.DIRECTORIES_ONLY);
  }
  String path=textfieldDirectoryPath.getText();
  if (path.isEmpty()) {
    fileChooser.setCurrentDirectory(lastSelectedDirectory.toFile());
  }
 else {
    fileChooser.setCurrentDirectory(Paths.get(path).toFile());
  }
  int result=fileChooser.showOpenDialog(frame);
  if (result == JFileChooser.CANCEL_OPTION) {
    return null;
  }
  Path selectedDirectory=fileChooser.getSelectedFile().toPath();
  String filepath="";
  if (selectedDirectory != null) {
    filepath=selectedDirectory.toAbsolutePath().toString();
  }
  textfieldDirectoryPath.setText(filepath);
  return selectedDirectory;
}
