{
  couldNotFindPipe=false;
  couldNotWrite=false;
  String lyxpipeSetting=Globals.prefs.get("lyxpipe");
  if (!lyxpipeSetting.endsWith(".in"))   lyxpipeSetting=lyxpipeSetting + ".in";
  File lp=new File(lyxpipeSetting);
  if (!lp.exists() || !lp.canWrite()) {
    lp=new File(lyxpipeSetting + ".in");
    if (!lp.exists() || !lp.canWrite()) {
      couldNotFindPipe=true;
      return;
    }
  }
  final File lyxpipe=lp;
  Thread t=new Thread(new Runnable(){
    public void run(){
      try {
        FileWriter fw=new FileWriter(lyxpipe);
        BufferedWriter lyx_out=new BufferedWriter(fw);
        String citeStr="";
        citeStr="LYXCMD:sampleclient:citation-insert:" + keyString;
        lyx_out.write(citeStr + "\n");
        lyx_out.close();
      }
 catch (      IOException excep) {
        couldNotWrite=true;
      }
    }
  }
);
  t.start();
  try {
    t.join();
  }
 catch (  InterruptedException e) {
    e.printStackTrace();
  }
}
