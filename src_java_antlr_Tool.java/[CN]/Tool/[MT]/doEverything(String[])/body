{
  antlr.preprocessor.Tool preTool=new antlr.preprocessor.Tool(this,args);
  boolean preprocess_ok=preTool.preprocess();
  String[] modifiedArgs=preTool.preprocessedArgList();
  processArguments(modifiedArgs);
  if (!preprocess_ok) {
    return 1;
  }
  f=getGrammarReader();
  ANTLRLexer lexer=new ANTLRLexer(f);
  TokenBuffer tokenBuf=new TokenBuffer(lexer);
  LLkAnalyzer analyzer=new LLkAnalyzer(this);
  MakeGrammar behavior=new MakeGrammar(this,args,analyzer);
  try {
    ANTLRParser p=new ANTLRParser(tokenBuf,behavior,this);
    p.setFilename(grammarFile);
    p.grammar();
    if (hasError()) {
      fatalError("Exiting due to errors.");
    }
    checkForInvalidArguments(modifiedArgs,cmdLineArgValid);
    CodeGenerator codeGen;
    String codeGenClassName="antlr." + getLanguage(behavior) + "CodeGenerator";
    try {
      Class codeGenClass=Class.forName(codeGenClassName);
      codeGen=(CodeGenerator)codeGenClass.newInstance();
      codeGen.setBehavior(behavior);
      codeGen.setAnalyzer(analyzer);
      codeGen.setTool(this);
      codeGen.gen();
    }
 catch (    ClassNotFoundException cnfe) {
      panic("Cannot instantiate code-generator: " + codeGenClassName);
    }
catch (    InstantiationException ie) {
      panic("Cannot instantiate code-generator: " + codeGenClassName);
    }
catch (    IllegalArgumentException ie) {
      panic("Cannot instantiate code-generator: " + codeGenClassName);
    }
catch (    IllegalAccessException iae) {
      panic("code-generator class '" + codeGenClassName + "' is not accessible");
    }
  }
 catch (  RecognitionException pe) {
    fatalError("Unhandled parser error: " + pe.getMessage());
  }
catch (  TokenStreamException io) {
    fatalError("TokenStreamException: " + io.getMessage());
  }
  return 0;
}
