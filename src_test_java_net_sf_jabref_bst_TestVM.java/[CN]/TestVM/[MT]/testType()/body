{
  VM vm=new VM("" + "ENTRY  { title }  { }  { label }" + "FUNCTION {presort} { cite$ 'sort.key$ := } ITERATE { presort } SORT FUNCTION {test} { type$ } ITERATE { test }");
  Vector<BibEntry> v=new Vector<>();
  v.add(TestVM.bibtexString2BibtexEntry("@article{a, author=\"AAA\"}"));
  v.add(TestVM.bibtexString2BibtexEntry("@book{b, author=\"BBB\"}"));
  v.add(TestVM.bibtexString2BibtexEntry("@misc{c, author=\"CCC\"}"));
  v.add(TestVM.bibtexString2BibtexEntry("@inproceedings{d, author=\"DDD\"}"));
  vm.run(v);
  Assert.assertEquals(4,vm.getStack().size());
  Assert.assertEquals("InProceedings",vm.getStack().pop());
  Assert.assertEquals("Misc",vm.getStack().pop());
  Assert.assertEquals("Book",vm.getStack().pop());
  Assert.assertEquals("Article",vm.getStack().pop());
}
