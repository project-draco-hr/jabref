{
{
    VM vm=new VM("FUNCTION {test} { \"H\" \"allo\" * \"Johnny\" add.period$ \"Johnny.\" add.period$" + "\"Johnny!\" add.period$ \"Johnny?\" add.period$ \"Johnny} }}}\" add.period$" + "\"Johnny!}\" add.period$ \"Johnny?}\" add.period$ \"Johnny.}\" add.period$ }"+ "EXECUTE {test}");
    Vector<BibtexEntry> v=new Vector<BibtexEntry>();
    vm.run(v);
    assertEquals("Johnny.}",vm.getStack().pop());
    assertEquals("Johnny?}",vm.getStack().pop());
    assertEquals("Johnny!}",vm.getStack().pop());
    assertEquals("Johnny.}",vm.getStack().pop());
    assertEquals("Johnny?",vm.getStack().pop());
    assertEquals("Johnny!",vm.getStack().pop());
    assertEquals("Johnny.",vm.getStack().pop());
    assertEquals("Johnny.",vm.getStack().pop());
    assertEquals("Hallo",vm.getStack().pop());
    assertEquals(0,vm.getStack().size());
  }
}
