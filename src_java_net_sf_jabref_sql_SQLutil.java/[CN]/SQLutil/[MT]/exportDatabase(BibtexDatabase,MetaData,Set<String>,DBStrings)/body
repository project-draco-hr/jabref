{
  DBTYPE dbtype=getDBType(dbStrings);
  Connection conn=null;
  try {
    conn=SQLutil.connectToDB(dbStrings);
    exportDatabase_worker(dbtype,database,metaData,keySet,conn);
    if (!conn.getAutoCommit()) {
      conn.commit();
      conn.setAutoCommit(true);
    }
    conn.close();
  }
 catch (  SQLException ex) {
    if (conn != null) {
      if (!conn.getAutoCommit()) {
        conn.rollback();
      }
    }
    throw ex;
  }
}
