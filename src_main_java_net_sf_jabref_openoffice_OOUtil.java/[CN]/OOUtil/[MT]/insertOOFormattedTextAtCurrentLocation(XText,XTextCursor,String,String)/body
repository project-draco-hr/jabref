{
  XParagraphCursor parCursor=UnoRuntime.queryInterface(XParagraphCursor.class,cursor);
  XPropertySet props=UnoRuntime.queryInterface(XPropertySet.class,parCursor);
  try {
    props.setPropertyValue(PARA_STYLE_NAME,parStyle);
  }
 catch (  IllegalArgumentException ex) {
    throw new UndefinedParagraphFormatException(parStyle);
  }
  BitSet formatting=new BitSet(TOTAL_FORMAT_COUNT);
  int piv=0;
  Matcher m=OOUtil.HTML_TAG.matcher(lText);
  while (m.find()) {
    String ss=lText.substring(piv,m.start());
    if (!ss.isEmpty()) {
      OOUtil.insertTextAtCurrentLocation(text,cursor,ss,formatting);
    }
    String tag=m.group();
    if ("<b>".equals(tag)) {
      formatting.set(FORMAT_BOLD);
    }
 else     if ("</b>".equals(tag)) {
      formatting.clear(FORMAT_BOLD);
    }
 else     if ("<i>".equals(tag) || "<em>".equals(tag)) {
      formatting.set(FORMAT_ITALIC);
    }
 else     if ("</i>".equals(tag) || "</em>".equals(tag)) {
      formatting.clear(FORMAT_ITALIC);
    }
 else     if ("<tt>".equals(tag)) {
      formatting.set(FORMAT_MONOSPACE);
    }
 else     if ("</tt>".equals(tag)) {
      formatting.clear(FORMAT_MONOSPACE);
    }
 else     if ("<smallcaps>".equals(tag)) {
      formatting.set(FORMAT_SMALLCAPS);
    }
 else     if ("</smallcaps>".equals(tag)) {
      formatting.clear(FORMAT_SMALLCAPS);
    }
 else     if ("<sup>".equals(tag)) {
      formatting.set(FORMAT_SUPERSCRIPT);
    }
 else     if ("</sup>".equals(tag)) {
      formatting.clear(FORMAT_SUPERSCRIPT);
    }
 else     if ("<sub>".equals(tag)) {
      formatting.set(FORMAT_SUBSCRIPT);
    }
 else     if ("</sub>".equals(tag)) {
      formatting.clear(FORMAT_SUBSCRIPT);
    }
 else     if ("<u>".equals(tag)) {
      formatting.set(FORMAT_UNDERLINE);
    }
 else     if ("</u>".equals(tag)) {
      formatting.clear(FORMAT_UNDERLINE);
    }
 else     if ("<s>".equals(tag)) {
      formatting.set(FORMAT_STRIKEOUT);
    }
 else     if ("</s>".equals(tag)) {
      formatting.clear(FORMAT_STRIKEOUT);
    }
    piv=m.end();
  }
  if (piv < lText.length()) {
    OOUtil.insertTextAtCurrentLocation(text,cursor,lText.substring(piv),formatting);
  }
  cursor.collapseToEnd();
}
