{
  Reader reader;
  Reader utf8Reader=ImportFormatReader.getReader(fileToOpen,"UTF8");
  String suppliedEncoding=checkForEncoding(utf8Reader);
  utf8Reader.close();
  if (suppliedEncoding == null) {
    Reader utf16Reader=ImportFormatReader.getReader(fileToOpen,"UTF-16");
    suppliedEncoding=checkForEncoding(utf16Reader);
    utf16Reader.close();
  }
  if ((suppliedEncoding != null)) {
    try {
      reader=ImportFormatReader.getReader(fileToOpen,suppliedEncoding.trim());
      encoding=suppliedEncoding;
    }
 catch (    Exception ex) {
      ex.printStackTrace();
      reader=ImportFormatReader.getReader(fileToOpen,encoding);
    }
  }
 else {
    reader=ImportFormatReader.getReader(fileToOpen,encoding);
  }
  BibtexParser bp=new BibtexParser(reader);
  ParserResult pr=bp.parse();
  pr.setEncoding(encoding);
  return pr;
}
