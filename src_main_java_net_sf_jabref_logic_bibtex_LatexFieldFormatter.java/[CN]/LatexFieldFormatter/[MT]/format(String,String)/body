{
  if (content == null) {
    return prefs.getValueDelimiterStartOfValue() + String.valueOf(prefs.getValueDelimiterEndOfValue());
  }
  String result=content;
  boolean shouldNormalizeNewlines=!result.contains(Globals.NEWLINE) && result.contains("\n");
  if (shouldNormalizeNewlines) {
    result=result.replace("\n",Globals.NEWLINE);
  }
  boolean resolveStrings=shouldResolveStrings(fieldName);
  if (!resolveStrings) {
    return formatWithoutResolvingStrings(result,fieldName);
  }
  result=result.trim();
  return formatAndResolveStrings(result,fieldName);
}
