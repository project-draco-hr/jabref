{
  SortedSet<ImportFormat> importers=Globals.importFormatReader.getImportFormats();
  String lastUsedFormat=Globals.prefs.get(JabRefPreferences.LAST_USED_IMPORT);
  FileFilter defaultFilter=null;
  JFileChooser fc=new JFileChooser(currentDir);
  TreeSet<ImportFileFilter> filters=new TreeSet<>();
  for (  ImportFormat format : importers) {
    ImportFileFilter filter=new ImportFileFilter(format);
    filters.add(filter);
    if (format.getFormatName().equals(lastUsedFormat)) {
      defaultFilter=filter;
    }
  }
  for (  ImportFileFilter filter : filters) {
    fc.addChoosableFileFilter(filter);
  }
  if (defaultFilter == null) {
    fc.setFileFilter(fc.getAcceptAllFileFilter());
  }
 else {
    fc.setFileFilter(defaultFilter);
  }
  return fc;
}
