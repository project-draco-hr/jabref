{
  String filename=Paths.get(JabRefMain.class.getResource(StyleLoader.DEFAULT_AUTHORYEAR_STYLE_PATH).toURI()).toFile().getPath();
  preferences.setExternalStyles(Collections.singletonList(filename));
  loader=new StyleLoader(new OpenOfficePreferences(Globals.prefs),mock(JournalAbbreviationRepository.class),Globals.prefs.getDefaultEncoding());
  List<OOBibStyle> toremove=new ArrayList<>();
  int beforeRemoving=loader.getStyles().size();
  for (  OOBibStyle style : loader.getStyles()) {
    if (!style.isFromResource()) {
      toremove.add(style);
    }
  }
  for (  OOBibStyle style : toremove) {
    assertTrue(loader.removeStyle(style));
  }
  assertEquals(beforeRemoving - 1,loader.getStyles().size());
}
