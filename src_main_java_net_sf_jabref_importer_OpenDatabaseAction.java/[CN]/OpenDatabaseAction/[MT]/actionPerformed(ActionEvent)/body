{
  List<File> filesToOpen=new ArrayList<>();
  if (showDialog) {
    String[] chosen=FileDialogs.getMultipleFiles(frame,new File(Globals.prefs.get(JabRefPreferences.WORKING_DIRECTORY)),".bib",true);
    if (chosen != null) {
      for (      String aChosen : chosen) {
        if (aChosen != null) {
          filesToOpen.add(new File(aChosen));
        }
      }
    }
  }
 else {
    LOGGER.info(Action.NAME + " " + e.getActionCommand());
    filesToOpen.add(new File(StringUtil.getCorrectFileName(e.getActionCommand(),"bib")));
  }
  BasePanel toRaise=null;
  int initialCount=filesToOpen.size();
  int removed=0;
  for (Iterator<File> iterator=filesToOpen.iterator(); iterator.hasNext(); ) {
    File file=iterator.next();
    for (int i=0; i < frame.getTabbedPane().getTabCount(); i++) {
      BasePanel bp=frame.getBasePanelAt(i);
      if ((bp.getDatabaseFile() != null) && bp.getDatabaseFile().equals(file)) {
        iterator.remove();
        removed++;
        if (removed == initialCount) {
          toRaise=bp;
        }
        break;
      }
    }
  }
  if (!filesToOpen.isEmpty()) {
    final List<File> theFiles=Collections.unmodifiableList(filesToOpen);
    JabRefExecutorService.INSTANCE.execute(new Runnable(){
      @Override public void run(){
        for (        File theFile : theFiles) {
          openIt(theFile,true);
        }
      }
    }
);
    for (    File theFile : theFiles) {
      frame.getFileHistory().newFile(theFile.getPath());
    }
  }
 else   if (toRaise != null) {
    frame.output(Localization.lang("File '%0' is already open.",toRaise.getDatabaseFile().getPath()));
    frame.getTabbedPane().setSelectedComponent(toRaise);
  }
}
