{
  if (colSetup.isEditing()) {
    int col=colSetup.getEditingColumn(), row=colSetup.getEditingRow();
    colSetup.getCellEditor(row,col).stopCellEditing();
  }
  if (tableChanged) {
    int i=0;
    while (i < tableRows.size()) {
      if (((TableRow)tableRows.elementAt(i)).name.equals(""))       tableRows.removeElementAt(i);
 else       i++;
    }
    String[] names=new String[tableRows.size()], widths=new String[tableRows.size()];
    int[] nWidths=new int[tableRows.size()];
    for (i=0; i < tableRows.size(); i++) {
      TableRow tr=(TableRow)tableRows.elementAt(i);
      names[i]=tr.name;
      nWidths[i]=tr.length;
      widths[i]="" + tr.length;
    }
    _prefs.putStringArray("columnNames",names);
    _prefs.putStringArray("columnWidths",widths);
  }
  _prefs.putBoolean("tableColorCodesOn",colorCodes.isSelected());
  _prefs.putBoolean("namesAsIs",namesAsIs.isSelected());
  _prefs.putBoolean("namesFf",namesFf.isSelected());
  _prefs.putBoolean("antialias",antialias.isSelected());
  _prefs.putInt("autoResizeMode",autoResizeMode.isSelected() ? JTable.AUTO_RESIZE_ALL_COLUMNS : JTable.AUTO_RESIZE_OFF);
  _prefs.putBoolean("secDescending",secDesc.isSelected());
  _prefs.putBoolean("terDescending",terDesc.isSelected());
  _prefs.put("secSort",GUIGlobals.ALL_FIELDS[secSort.getSelectedIndex()]);
  _prefs.put("terSort",GUIGlobals.ALL_FIELDS[terSort.getSelectedIndex()]);
  _prefs.put("fontFamily",font.getFamily());
  _prefs.putInt("fontStyle",font.getStyle());
  _prefs.putInt("fontSize",font.getSize());
  GUIGlobals.CURRENTFONT=font;
}
