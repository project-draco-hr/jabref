{
  File f=null;
  if (newFile.isSelected()) {
    if (newNameTf.getText().length() > 0) {
      f=new File(newNameTf.getText());
    }
  }
 else   f=new File(personalFile.getText());
  if (f != null) {
    FileWriter fw=null;
    try {
      fw=new FileWriter(f,false);
      for (Iterator i=tableModel.getJournals().iterator(); i.hasNext(); ) {
        JournalEntry entry=(JournalEntry)i.next();
        fw.write(entry.name);
        fw.write(" = ");
        fw.write(entry.abbreviation);
        fw.write(Globals.NEWLINE);
      }
    }
 catch (    IOException e) {
      e.printStackTrace();
    }
 finally {
      if (fw != null)       try {
        fw.close();
      }
 catch (      IOException e) {
        e.printStackTrace();
      }
    }
    String filename=f.getPath();
    if (filename.equals(""))     filename=null;
    Globals.prefs.put("personalJournalList",filename);
  }
  ArrayList extFiles=new ArrayList();
  for (Iterator i=externals.iterator(); i.hasNext(); ) {
    ExternalFileEntry efe=(ExternalFileEntry)i.next();
    if (!efe.getValue().equals("")) {
      extFiles.add(efe.getValue());
    }
  }
  if (extFiles.size() == 0)   Globals.prefs.put("externalJournalLists","");
 else {
    String[] list=(String[])extFiles.toArray(new String[extFiles.size()]);
    Globals.prefs.putStringArray("externalJournalLists",list);
  }
  Globals.initializeJournalNames();
}
