{
  if (fieldPattern.matcher("entrytype").matches()) {
    return matchFieldValue(entry.getType());
  }
  Set<String> fieldsKeys=entry.getFieldNames();
  List<String> matchedFieldKeys=fieldsKeys.stream().filter(matchFieldKey()).collect(Collectors.toList());
  for (  String field : matchedFieldKeys) {
    Optional<String> fieldValue=entry.getFieldOptional(field);
    if (fieldValue.isPresent()) {
      if (matchFieldValue(fieldValue.get())) {
        return true;
      }
    }
  }
  return matchedFieldKeys.isEmpty() && (operator == ComparisonOperator.DOES_NOT_CONTAIN);
}
