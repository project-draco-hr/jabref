{
  try (PDDocument document=PDDocument.load(tempFile.getAbsoluteFile())){
    if (document.isEncrypted()) {
      System.err.println("Error: Cannot add metadata to encrypted document.");
    }
    PDDocumentCatalog catalog=document.getDocumentCatalog();
    PDMetadata meta=catalog.getMetadata();
    if (meta == null) {
      return null;
    }
 else {
      try (InputStreamReader is=new InputStreamReader(meta.createInputStream(),StandardCharsets.UTF_8)){
        return XMPUtilTest.slurp(is).trim();
      }
     }
  }
 }
