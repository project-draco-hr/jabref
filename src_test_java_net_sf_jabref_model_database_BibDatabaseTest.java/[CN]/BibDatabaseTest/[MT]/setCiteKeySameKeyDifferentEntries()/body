{
  BibEntry entry=new BibEntry();
  entry.setCiteKey("AAA");
  database.insertEntryWithDuplicationCheck(entry);
  entry=new BibEntry();
  entry.setCiteKey("BBB");
  database.insertEntryWithDuplicationCheck(entry);
  assertTrue(database.setCiteKeyForEntry(entry,"AAA"));
  assertEquals(entry.getCiteKeyOptional(),Optional.of("AAA"));
  assertEquals(database.getNumberOfKeyOccurrences("AAA"),2);
  assertEquals(database.getNumberOfKeyOccurrences("BBB"),0);
}
