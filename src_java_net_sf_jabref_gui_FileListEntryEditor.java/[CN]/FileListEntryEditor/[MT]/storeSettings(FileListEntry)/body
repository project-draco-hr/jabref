{
  entry.setDescription(description.getText().trim());
  try {
    String fileDir=metaData.getFileDirectory(GUIGlobals.FILE_FIELD);
    if ((fileDir == null) || (fileDir.equals(""))) {
      entry.setLink(link.getText().trim());
    }
 else {
      String canPath=(new File(fileDir)).getCanonicalPath();
      File fl=new File(link.getText().trim());
      if (fl.isAbsolute()) {
        String flPath=fl.getCanonicalPath();
        if ((flPath.length() > canPath.length()) && (flPath.startsWith(canPath))) {
          String relFileName=fl.getCanonicalPath().substring(canPath.length() + 1);
          entry.setLink(relFileName);
        }
 else         entry.setLink(link.getText().trim());
      }
 else       entry.setLink(link.getText().trim());
    }
  }
 catch (  java.io.IOException ex) {
    ex.printStackTrace();
    entry.setLink(link.getText().trim());
  }
  entry.setType((ExternalFileType)types.getSelectedItem());
}
