{
  List<String> dirs=new ArrayList<>();
  String key=Globals.prefs.get(JabRefPreferences.USER_FILE_DIR_INDIVIDUAL);
  Vector<String> vec=getData(key);
  if (vec == null) {
    key=Globals.prefs.get(JabRefPreferences.USER_FILE_DIR);
    vec=getData(key);
  }
  if ((vec != null) && !vec.isEmpty()) {
    String dir;
    dir=vec.get(0);
    if (!new File(dir).isAbsolute() && (file != null)) {
      String relDir;
      if (".".equals(dir)) {
        relDir=file.getParent();
      }
 else {
        relDir=file.getParent() + System.getProperty("file.separator") + dir;
      }
      if (new File(relDir).exists()) {
        dir=relDir;
      }
    }
    dirs.add(dir);
  }
 else {
    String dir=Globals.prefs.get(fieldName + Globals.DIR_SUFFIX);
    if (dir != null) {
      dirs.add(dir);
    }
  }
  if (Globals.prefs.getBoolean(JabRefPreferences.BIB_LOCATION_AS_FILE_DIR) && (getFile() != null)) {
    if (Globals.prefs.getBoolean(JabRefPreferences.BIB_LOC_AS_PRIMARY_DIR)) {
      dirs.add(0,getFile().getParent());
    }
 else {
      dirs.add(getFile().getParent());
    }
  }
  return dirs.toArray(new String[dirs.size()]);
}
