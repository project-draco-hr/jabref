{
  SaveOrder saveOrder;
  String prefix=isSaveOperation ? "save" : "export";
  if (Globals.prefs.getBoolean(prefix + "InSpecifiedOrder")) {
    saveOrder=SaveOrder.Specified;
  }
 else {
    saveOrder=SaveOrder.TableSort;
  }
switch (saveOrder) {
case TableSort:
    pri=Globals.prefs.get("priSort");
  sec=Globals.prefs.get("secSort");
ter=Globals.prefs.get("terSort");
priD=Globals.prefs.getBoolean("priDescending");
secD=Globals.prefs.getBoolean("secDescending");
terD=Globals.prefs.getBoolean("terDescending");
break;
case Specified:
default :
pri=Globals.prefs.get(prefix + "PriSort");
sec=Globals.prefs.get(prefix + "SecSort");
ter=Globals.prefs.get(prefix + "TerSort");
priD=Globals.prefs.getBoolean(prefix + "PriDescending");
secD=Globals.prefs.getBoolean(prefix + "SecDescending");
terD=Globals.prefs.getBoolean(prefix + "TerDescending");
}
}
