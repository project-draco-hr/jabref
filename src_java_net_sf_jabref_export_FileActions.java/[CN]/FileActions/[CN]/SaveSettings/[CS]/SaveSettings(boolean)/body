{
  SaveOrder saveOrder;
  String prefix=isSaveOperation ? "save" : "export";
  if (Globals.prefs.getBoolean(prefix + "InStandardOrder")) {
    saveOrder=SaveOrder.Standard;
  }
 else   if (Globals.prefs.getBoolean(prefix + "InTitleOrder")) {
    saveOrder=SaveOrder.Title;
  }
 else {
    saveOrder=SaveOrder.TableSort;
  }
switch (saveOrder) {
case TableSort:
    pri=Globals.prefs.get("priSort");
  sec=Globals.prefs.get("secSort");
ter=Globals.prefs.get("terSort");
priD=Globals.prefs.getBoolean("priDescending");
secD=Globals.prefs.getBoolean("secDescending");
terD=Globals.prefs.getBoolean("terDescending");
break;
case Title:
pri="title";
sec="author";
ter="editor";
priD=false;
secD=false;
terD=false;
break;
case Standard:
default :
pri="author";
sec="editor";
ter="year";
priD=false;
secD=false;
terD=true;
break;
}
}
