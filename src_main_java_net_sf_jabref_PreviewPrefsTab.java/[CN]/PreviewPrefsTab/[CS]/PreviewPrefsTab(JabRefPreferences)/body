{
  _prefs=prefs;
  JPanel p1=new JPanel();
  GridBagLayout gbl=new GridBagLayout();
  p1.setLayout(gbl);
  JPanel p2=new JPanel();
  p2.setLayout(gbl);
  setLayout(gbl);
  JLabel lab;
  lab=new JLabel(Globals.lang("Preview") + " 1");
  GridBagConstraints con=new GridBagConstraints();
  con.anchor=GridBagConstraints.WEST;
  con.gridwidth=GridBagConstraints.REMAINDER;
  con.fill=GridBagConstraints.BOTH;
  con.weightx=1;
  con.weighty=0;
  con.insets=new Insets(2,2,2,2);
  gbl.setConstraints(lab,con);
  con.weighty=1;
  JScrollPane sp1=new JScrollPane(layout1);
  gbl.setConstraints(sp1,con);
  p1.add(sp1);
  con.weighty=0;
  con.gridwidth=1;
  con.weightx=0;
  con.fill=GridBagConstraints.NONE;
  con.anchor=GridBagConstraints.WEST;
  JButton test1=new JButton(Globals.lang("Test"));
  gbl.setConstraints(test1,con);
  p1.add(test1);
  JButton def1=new JButton(Globals.lang("Default"));
  gbl.setConstraints(def1,con);
  p1.add(def1);
  con.gridwidth=GridBagConstraints.REMAINDER;
  JPanel pan=new JPanel();
  con.weightx=1;
  gbl.setConstraints(pan,con);
  p1.add(pan);
  lab=new JLabel(Globals.lang("Preview") + " 2");
  gbl.setConstraints(lab,con);
  con.weighty=1;
  con.fill=GridBagConstraints.BOTH;
  JScrollPane sp2=new JScrollPane(layout2);
  gbl.setConstraints(sp2,con);
  p2.add(sp2);
  con.weighty=0;
  con.weightx=0;
  con.fill=GridBagConstraints.NONE;
  con.gridwidth=1;
  JButton test2=new JButton(Globals.lang("Test"));
  gbl.setConstraints(test2,con);
  p2.add(test2);
  JButton def2=new JButton(Globals.lang("Default"));
  gbl.setConstraints(def2,con);
  p2.add(def2);
  con.gridwidth=1;
  pan=new JPanel();
  con.weightx=1;
  gbl.setConstraints(pan,con);
  p2.add(pan);
  con.weightx=1;
  con.weighty=0;
  con.fill=GridBagConstraints.BOTH;
  con.gridwidth=GridBagConstraints.REMAINDER;
  lab=new JLabel(Globals.lang("Preview") + " 1");
  gbl.setConstraints(lab,con);
  add(lab);
  con.weighty=1;
  gbl.setConstraints(p1,con);
  add(p1);
  lab=new JLabel(Globals.lang("Preview") + " 2");
  con.weighty=0;
  JSeparator sep=new JSeparator(SwingConstants.HORIZONTAL);
  gbl.setConstraints(sep,con);
  add(sep);
  gbl.setConstraints(lab,con);
  add(lab);
  con.weighty=1;
  gbl.setConstraints(p2,con);
  add(p2);
  JPanel p3=new JPanel(new BorderLayout());
  p3.add(pdfPreview,BorderLayout.WEST);
{
    HelpAction helpAction=new HelpAction(Globals.helpDiag,GUIGlobals.previewHelp,Globals.lang("Help on Preview Settings"),GUIGlobals.getIconUrl("helpSmall"));
    JButton help=helpAction.getIconButton();
    p3.add(help,BorderLayout.EAST);
  }
  con.weighty=0;
  gbl.setConstraints(p3,con);
  add(p3);
  def1.addActionListener(new ActionListener(){
    @Override public void actionPerformed(    ActionEvent e){
      String tmp=layout1.getText().replaceAll("\n","__NEWLINE__");
      _prefs.remove(JabRefPreferences.PREVIEW_0);
      layout1.setText(_prefs.get(JabRefPreferences.PREVIEW_0).replaceAll("__NEWLINE__","\n"));
      _prefs.put(JabRefPreferences.PREVIEW_0,tmp);
    }
  }
);
  def2.addActionListener(new ActionListener(){
    @Override public void actionPerformed(    ActionEvent e){
      String tmp=layout2.getText().replaceAll("\n","__NEWLINE__");
      _prefs.remove(JabRefPreferences.PREVIEW_1);
      layout2.setText(_prefs.get(JabRefPreferences.PREVIEW_1).replaceAll("__NEWLINE__","\n"));
      _prefs.put(JabRefPreferences.PREVIEW_1,tmp);
    }
  }
);
  test1.addActionListener(new ActionListener(){
    @Override public void actionPerformed(    ActionEvent e){
      PreviewPrefsTab.getTestEntry();
      try {
        PreviewPanel testPanel=new PreviewPanel(null,PreviewPrefsTab.entry,null,new MetaData(),layout1.getText());
        testPanel.setPreferredSize(new Dimension(800,350));
        JOptionPane.showMessageDialog(null,testPanel,Globals.lang("Preview"),JOptionPane.PLAIN_MESSAGE);
      }
 catch (      StringIndexOutOfBoundsException ex) {
        ex.printStackTrace();
        JOptionPane.showMessageDialog(null,Globals.lang("Parsing error") + ": " + Globals.lang("illegal backslash expression")+ ".\n"+ ex.getMessage()+ '\n'+ Globals.lang("Look at stderr for details")+ '.',Globals.lang("Parsing error"),JOptionPane.ERROR_MESSAGE);
      }
    }
  }
);
  test2.addActionListener(new ActionListener(){
    @Override public void actionPerformed(    ActionEvent e){
      PreviewPrefsTab.getTestEntry();
      try {
        PreviewPanel testPanel=new PreviewPanel(null,PreviewPrefsTab.entry,null,new MetaData(),layout2.getText());
        testPanel.setPreferredSize(new Dimension(800,350));
        JOptionPane.showMessageDialog(null,new JScrollPane(testPanel),Globals.lang("Preview"),JOptionPane.PLAIN_MESSAGE);
      }
 catch (      StringIndexOutOfBoundsException ex) {
        ex.printStackTrace();
        JOptionPane.showMessageDialog(null,"Parsing error: illegal backslash expression.\n" + ex.getMessage() + "\nLook at stderr for details.","Parsing error",JOptionPane.ERROR_MESSAGE);
      }
    }
  }
);
}
