{
  if (cancelled || (panel.getFile() == null)) {
    return;
  }
  try {
    panel.storeCurrentEdit();
    panel.autoGenerateKeysBeforeSaving();
    success=saveDatabase(panel.getFile(),false,panel.getEncoding());
    try {
      Globals.fileUpdateMonitor.updateTimeStamp(panel.getFileMonitorHandle());
    }
 catch (    IllegalArgumentException ex) {
    }
    panel.setSaving(false);
    if (success) {
      panel.undoManager.markUnchanged();
      panel.setNonUndoableChange(false);
      panel.setBaseChanged(false);
      panel.setUpdatedExternally(false);
    }
  }
 catch (  SaveException ex2) {
    ex2.printStackTrace();
  }
}
