{
  BibEntry firstEntry=new BibEntry(IdGenerator.next());
  firstEntry.setType(BibtexEntryTypes.ARTICLE);
  firstEntry.setField("author","A");
  firstEntry.setField("year","2010");
  BibEntry secondEntry=new BibEntry(IdGenerator.next());
  secondEntry.setType(BibtexEntryTypes.ARTICLE);
  secondEntry.setField("author","B");
  secondEntry.setField("year","2000");
  BibEntry thirdEntry=new BibEntry(IdGenerator.next());
  thirdEntry.setType(BibtexEntryTypes.ARTICLE);
  thirdEntry.setField("author","A");
  thirdEntry.setField("year","2000");
  database.insertEntry(firstEntry);
  database.insertEntry(secondEntry);
  database.insertEntry(thirdEntry);
  SavePreferences preferences=new SavePreferences().withSaveInOriginalOrder(false);
  databaseWriter.writePartOfDatabase(stringWriter,bibtexContext,database.getEntries(),preferences);
  assertEquals(Globals.NEWLINE + "@Article{," + Globals.NEWLINE+ "  author = {A},"+ Globals.NEWLINE+ "  year   = {2010},"+ Globals.NEWLINE+ "}"+ Globals.NEWLINE+ Globals.NEWLINE+ "@Article{,"+ Globals.NEWLINE+ "  author = {B},"+ Globals.NEWLINE+ "  year   = {2000},"+ Globals.NEWLINE+ "}"+ Globals.NEWLINE+ Globals.NEWLINE+ "@Article{,"+ Globals.NEWLINE+ "  author = {A},"+ Globals.NEWLINE+ "  year   = {2000},"+ Globals.NEWLINE+ "}"+ Globals.NEWLINE+ Globals.NEWLINE+ "@Comment{jabref-meta: databaseType:bibtex;}"+ Globals.NEWLINE,stringWriter.toString());
}
