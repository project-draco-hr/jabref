{
  BibDatabaseWriter databaseWriter=new BibDatabaseWriter();
  BibEntry entry=new BibEntry();
  entry.setType(BibtexEntryTypes.ARTICLE);
  entry.setField("author","Mr. author");
  entry.setParsedSerialization("wrong serialization");
  entry.setChanged(false);
  BibDatabase database=new BibDatabase();
  database.insertEntry(entry);
  BibDatabaseContext context=new BibDatabaseContext(database,new Defaults(BibDatabaseMode.BIBTEX));
  StringWriter stringWriter=new StringWriter();
  SavePreferences preferences=new SavePreferences();
  preferences.setReformatFile(true);
  databaseWriter.writePartOfDatabase(stringWriter,context,Collections.singletonList(entry),preferences);
  Assert.assertEquals(Globals.NEWLINE + "@Article{," + Globals.NEWLINE+ "  author = {Mr. author}"+ Globals.NEWLINE+ "}"+ Globals.NEWLINE,stringWriter.toString());
}
