{
  Path testBibtexFile=Paths.get("src/test/resources/testbib/complex.bib");
  Charset encoding=StandardCharsets.UTF_8;
  ParserResult result=BibtexParser.parse(ImportFormat.getReader(testBibtexFile,encoding));
  BibtexString string=result.getDatabase().getStringValues().iterator().next();
  if (string.getContent().isEmpty()) {
  }
 else {
    string.setContent("my first string");
  }
  SavePreferences preferences=new SavePreferences().withEncoding(encoding).withSaveInOriginalOrder(true);
  BibDatabaseContext context=new BibDatabaseContext(result.getDatabase(),result.getMetaData(),new Defaults(BibDatabaseMode.BIBTEX));
  databaseWriter.writePartOfDatabase(stringWriter,context,result.getDatabase().getEntries(),preferences);
  try (Scanner scanner=new Scanner(testBibtexFile,encoding.name())){
    assertEquals(scanner.useDelimiter("\\A").next(),stringWriter.toString());
  }
 }
