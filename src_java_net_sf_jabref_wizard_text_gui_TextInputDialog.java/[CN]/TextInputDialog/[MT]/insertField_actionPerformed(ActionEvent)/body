{
  String type=(String)fieldList.getSelectedValue();
  if (type != null) {
    String txt=textPane.getSelectedText();
    int selStart=textPane.getSelectionStart();
    int selEnd=textPane.getSelectionEnd();
    textPane.setSelectionStart(-1);
    textPane.setSelectionEnd(-1);
    doc.setCharacterAttributes(selStart,selEnd - selStart,doc.getStyle("marked"),true);
    if (overRadio.isSelected()) {
      entry.setField(type,txt);
      marked.setStyleForTag(type,"regular",doc);
      marked.insertPosition(type,selStart,selEnd);
    }
 else {
      marked.appendPosition(type,selStart,selEnd);
      String old=(String)entry.getField(type);
      if (old != null)       entry.setField(type,old + txt);
 else       entry.setField(type,txt);
    }
    updateSourceView();
  }
}
