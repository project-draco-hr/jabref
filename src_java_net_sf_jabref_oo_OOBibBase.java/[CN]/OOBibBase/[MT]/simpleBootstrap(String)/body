{
  ClassLoader loader=ClassLoader.getSystemClassLoader();
  if (loader instanceof URLClassLoader) {
    URLClassLoader cl=(URLClassLoader)loader;
    Class sysclass=URLClassLoader.class;
    try {
      Method method=sysclass.getDeclaredMethod("addURL",new Class[]{URL.class});
      method.setAccessible(true);
      method.invoke(cl,new Object[]{new File(pathToExecutable).toURI().toURL()});
    }
 catch (    Throwable t) {
      t.printStackTrace();
      throw new IOException("Error, could not add URL to system classloader");
    }
  }
 else {
    System.out.println("Error occured, URLClassLoader expected but " + loader.getClass() + " received. Could not continue.");
  }
  XComponentContext xContext=Bootstrap.bootstrap();
  XMultiComponentFactory xServiceManager=xContext.getServiceManager();
  Object desktop=xServiceManager.createInstanceWithContext("com.sun.star.frame.Desktop",xContext);
  XDesktop xD=(XDesktop)UnoRuntime.queryInterface(XDesktop.class,desktop);
  xComponentLoader=(XComponentLoader)UnoRuntime.queryInterface(XComponentLoader.class,desktop);
  return xD;
}
