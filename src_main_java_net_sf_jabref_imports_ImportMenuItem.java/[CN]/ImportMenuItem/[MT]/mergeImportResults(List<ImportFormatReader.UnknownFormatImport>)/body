{
  BibtexDatabase database=new BibtexDatabase();
  ParserResult directParserResult=null;
  boolean anythingUseful=false;
  for (  ImportFormatReader.UnknownFormatImport importResult : imports) {
    if (importResult == null) {
      continue;
    }
    if (ImportFormatReader.BIBTEX_FORMAT.equals(importResult.format)) {
      ParserResult pr=importResult.parserResult;
      anythingUseful=anythingUseful || ((pr.getDatabase().getEntryCount() > 0) || (pr.getDatabase().getStringCount() > 0));
      if (directParserResult == null) {
        directParserResult=pr;
      }
      for (      BibtexEntry entry : pr.getDatabase().getEntries()) {
        database.insertEntry(entry);
      }
      for (      BibtexString bs : pr.getDatabase().getStringValues()) {
        try {
          database.addString((BibtexString)bs.clone());
        }
 catch (        KeyCollisionException e) {
        }
      }
    }
 else {
      ParserResult pr=importResult.parserResult;
      Collection<BibtexEntry> entries=pr.getDatabase().getEntries();
      anythingUseful=anythingUseful | (entries.size() > 0);
      Util.setAutomaticFields(entries,Globals.prefs.getBoolean("overwriteOwner"),Globals.prefs.getBoolean(JabRefPreferences.OVERWRITE_TIME_STAMP),!openInNew && Globals.prefs.getBoolean(JabRefPreferences.MARK_IMPORTED_ENTRIES));
      for (      BibtexEntry entry : entries) {
        database.insertEntry(entry);
      }
    }
  }
  if (!anythingUseful) {
    return null;
  }
  if ((imports.size() == 1) && (directParserResult != null)) {
    return directParserResult;
  }
 else {
    return new ParserResult(database,new MetaData(),new HashMap<String,BibtexEntryType>());
  }
}
