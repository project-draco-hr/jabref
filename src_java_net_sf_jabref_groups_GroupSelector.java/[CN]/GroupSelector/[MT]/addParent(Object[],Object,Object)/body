{
  Object[] newPath=new Object[path.length + 1];
  int newIdx=newPath.length - 1;
  int oldIdx=path.length - 1;
  for (; oldIdx >= 0; --oldIdx, --newIdx) {
    newPath[newIdx]=path[oldIdx];
    if (path[oldIdx] == node) {
      newPath[--newIdx]=newParent;
    }
  }
  return newIdx != oldIdx ? path : newPath;
}
