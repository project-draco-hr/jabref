{
  try {
    BibEntry be=sortedForGrouping.get(row);
    Optional<EntryType> type=EntryTypes.getType(be.getType(),panel.getBibDatabaseContext().getMode());
    if (type.isPresent()) {
      String columnName=getColumnName(col).toLowerCase();
      if (columnName.equals(BibEntry.KEY_FIELD) || type.get().getRequiredFieldsFlat().contains(columnName)) {
        return MainTable.REQUIRED;
      }
      if (type.get().getOptionalFields().contains(columnName)) {
        return MainTable.OPTIONAL;
      }
    }
    return MainTable.OTHER;
  }
 catch (  NullPointerException ex) {
    return MainTable.OTHER;
  }
}
