{
  try {
    BibEntry be=sortedForGrouping.get(row);
    EntryType type=EntryTypes.getType(be.getType(),panel.getBibDatabaseContext().getMode());
    String columnName=getColumnName(col).toLowerCase();
    if (columnName.equals(BibEntry.KEY_FIELD) || type.getRequiredFieldsFlat().contains(columnName)) {
      return MainTable.REQUIRED;
    }
    if (type.getOptionalFields().contains(columnName)) {
      return MainTable.OPTIONAL;
    }
    return MainTable.OTHER;
  }
 catch (  NullPointerException ex) {
    return MainTable.OTHER;
  }
}
