{
  String upToCaret;
  try {
    upToCaret=comp.getText(0,comp.getCaretPosition());
    upToCaret=upToCaret.substring(upToCaret.lastIndexOf(" and ") + 1);
    int commaIndex=upToCaret.indexOf(',');
    if (commaIndex < 0) {
      return AutoCompleteListener.ANY_NAME;
    }
 else {
      return AutoCompleteListener.FIRST_NAME;
    }
  }
 catch (  BadLocationException ex) {
    return AutoCompleteListener.ANY_NAME;
  }
}
