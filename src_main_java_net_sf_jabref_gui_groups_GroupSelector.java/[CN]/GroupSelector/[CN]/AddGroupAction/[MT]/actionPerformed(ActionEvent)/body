{
  final GroupDialog gd=new GroupDialog(frame,panel,null);
  gd.setVisible(true);
  if (!gd.okPressed()) {
    return;
  }
  final AbstractGroup newGroup=gd.getResultingGroup();
  final GroupTreeNode newNode=new GroupTreeNode(newGroup);
  final GroupTreeNodeViewModel node=getNodeToUse();
  if (node == null) {
    groupsRoot.getNode().add(newNode);
  }
 else {
    ((GroupTreeNodeViewModel)node.getParent()).getNode().insert(newNode,node.getParent().getIndex(node) + 1);
  }
  UndoableAddOrRemoveGroup undo=new UndoableAddOrRemoveGroup(GroupSelector.this,groupsRoot,new GroupTreeNodeViewModel(newNode),UndoableAddOrRemoveGroup.ADD_NODE);
  revalidateGroups();
  groupsTree.expandPath((node == null ? groupsRoot : node).getTreePath());
  panel.undoManager.addEdit(undo);
  panel.markBaseChanged();
  frame.output(Localization.lang("Added group \"%0\".",newGroup.getName()));
}
