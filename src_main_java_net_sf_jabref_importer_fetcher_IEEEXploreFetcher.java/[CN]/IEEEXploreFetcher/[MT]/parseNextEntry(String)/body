{
  BibtexEntry entry=null;
  int index=allText.indexOf("<div class=\"detail",piv);
  int endIndex=allText.indexOf("</div>",index);
  if ((index >= 0) && (endIndex > 0)) {
    endIndex+=6;
    piv=endIndex;
    String text=allText.substring(index,endIndex);
    EntryType type=null;
    String sourceField=null;
    String typeName="";
    Matcher typeMatcher=typePattern.matcher(text);
    if (typeMatcher.find()) {
      typeName=typeMatcher.group(1);
      if ("IEEE Journals &amp; Magazines".equalsIgnoreCase(typeName) || "IEEE Early Access Articles".equalsIgnoreCase(typeName) || "IET Journals &amp; Magazines".equalsIgnoreCase(typeName)|| "AIP Journals &amp; Magazines".equalsIgnoreCase(typeName)|| "AVS Journals &amp; Magazines".equalsIgnoreCase(typeName)|| "IBM Journals &amp; Magazines".equalsIgnoreCase(typeName)|| "TUP Journals &amp; Magazines".equalsIgnoreCase(typeName)|| "BIAI Journals &amp; Magazines".equalsIgnoreCase(typeName)|| "MIT Press Journals".equalsIgnoreCase(typeName)|| "Alcatel-Lucent Journal".equalsIgnoreCase(typeName)) {
        type=EntryTypes.getType("article");
        sourceField="journal";
      }
 else       if ("IEEE Conference Publications".equalsIgnoreCase(typeName) || "IET Conference Publications".equalsIgnoreCase(typeName) || "VDE Conference Publications".equalsIgnoreCase(typeName)) {
        type=EntryTypes.getType("inproceedings");
        sourceField="booktitle";
      }
 else       if ("IEEE Standards".equalsIgnoreCase(typeName) || "Standards".equalsIgnoreCase(typeName)) {
        type=EntryTypes.getType("standard");
        sourceField="number";
      }
 else       if ("IEEE eLearning Library Courses".equalsIgnoreCase(typeName)) {
        type=EntryTypes.getType("electronic");
        sourceField="note";
      }
 else       if ("Wiley-IEEE Press eBook Chapters".equalsIgnoreCase(typeName) || "MIT Press eBook Chapters".equalsIgnoreCase(typeName) || "IEEE USA Books &amp; eBooks".equalsIgnoreCase(typeName)) {
        type=EntryTypes.getType("incollection");
        sourceField="booktitle";
      }
 else       if ("Morgan and Claypool eBooks".equalsIgnoreCase(typeName)) {
        type=EntryTypes.getType("book");
        sourceField="note";
      }
    }
    if (type == null) {
      type=EntryTypes.getType("misc");
      sourceField="note";
      IEEEXploreFetcher.LOGGER.warn("Type detection failed. Use MISC instead. Type string: " + text);
      unparseable++;
    }
    entry=new BibtexEntry(IdGenerator.next(),type);
    if ("IEEE Standards".equalsIgnoreCase(typeName)) {
      entry.setField("organization","IEEE");
    }
    if ("Wiley-IEEE Press eBook Chapters".equalsIgnoreCase(typeName)) {
      entry.setField("publisher","Wiley-IEEE Press");
    }
 else     if ("MIT Press eBook Chapters".equalsIgnoreCase(typeName)) {
      entry.setField("publisher","MIT Press");
    }
 else     if ("IEEE USA Books &amp; eBooks".equalsIgnoreCase(typeName)) {
      entry.setField("publisher","IEEE USA");
    }
 else     if ("Morgan \\& Claypool eBooks".equalsIgnoreCase(typeName)) {
      entry.setField("publisher","Morgan and Claypool");
    }
    if ("IEEE Early Access Articles".equalsIgnoreCase(typeName)) {
      entry.setField("note","Early Access");
    }
    Set<String> fields=fieldPatterns.keySet();
    for (    String field : fields) {
      Matcher fieldMatcher=Pattern.compile(fieldPatterns.get(field)).matcher(text);
      if (fieldMatcher.find()) {
        entry.setField(field,htmlConverter.format(fieldMatcher.group(1)));
        if ("title".equals(field) && fieldMatcher.find()) {
          String sec_title=htmlConverter.format(fieldMatcher.group(1));
          if (entry.getType() == EntryTypes.getStandardType("standard")) {
            sec_title=sec_title.replaceAll("IEEE Std ","");
          }
          entry.setField(sourceField,sec_title);
        }
        if ("pages".equals(field) && (fieldMatcher.groupCount() == 2)) {
          entry.setField(field,fieldMatcher.group(1) + "-" + fieldMatcher.group(2));
        }
      }
    }
    Matcher authorMatcher=authorPattern.matcher(text);
    StringBuilder authorNames=new StringBuilder("");
    int authorCount=0;
    while (authorMatcher.find()) {
      if (authorCount >= 1) {
        authorNames.append(" and ");
      }
      authorNames.append(htmlConverter.format(authorMatcher.group(1)));
      authorCount++;
    }
    String authorString=authorNames.toString();
    if ((authorString == null) || authorString.startsWith("a href") || authorString.startsWith("Topic(s)")) {
      entry.setField("author","");
    }
 else {
      entry.setField("author",authorString);
    }
    if ((entry.getType() == EntryTypes.getStandardType("inproceedings")) && "".equals(entry.getField("author"))) {
      entry.setType(EntryTypes.getStandardType("proceedings"));
    }
    if (includeAbstract) {
      index=text.indexOf("id=\"abstract");
      if (index >= 0) {
        endIndex=text.indexOf("</div>",index) + 6;
        text=text.substring(index,endIndex);
        Matcher absMatcher=absPattern.matcher(text);
        if (absMatcher.find()) {
          String abstr=absMatcher.group(1);
          abstr=abstr.replaceAll("<span class='snippet'>([\\w]+)</span>","$1");
          entry.setField("abstract",htmlConverter.format(abstr));
        }
      }
    }
  }
  if (entry == null) {
    return null;
  }
  return cleanup(entry);
}
