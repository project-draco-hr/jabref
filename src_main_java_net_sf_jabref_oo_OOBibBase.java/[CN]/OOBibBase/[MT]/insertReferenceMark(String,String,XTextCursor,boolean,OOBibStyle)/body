{
  String pageInfo=getCustomProperty(name);
  if (pageInfo != null) {
    citText=style.insertPageInfo(citText,pageInfo);
  }
  Object bookmark=mxDocFactory.createInstance("com.sun.star.text.ReferenceMark");
  XNamed xNamed=UnoRuntime.queryInterface(XNamed.class,bookmark);
  xNamed.setName(name);
  XTextContent xTextContent=UnoRuntime.queryInterface(XTextContent.class,bookmark);
  if (withText) {
    position.setString(citText);
    XPropertySet xCursorProps=UnoRuntime.queryInterface(XPropertySet.class,position);
    xCursorProps.setPropertyValue("CharLocale",new Locale("zxx","",""));
    if (style.isFormatCitations()) {
      String charStyle=style.getCitationCharacterFormat();
      try {
        xCursorProps.setPropertyValue("CharStyleName",charStyle);
      }
 catch (      Throwable ex) {
        throw new UndefinedCharacterFormatException(charStyle);
      }
    }
  }
 else   position.setString("");
  position.getText().insertTextContent(position,xTextContent,true);
  boolean italicize=style.getBooleanCitProperty("ItalicEtAl");
  if (italicize) {
    String etAlString=style.getStringCitProperty("EtAlString");
    int index=citText.indexOf(etAlString);
    if (index >= 0) {
      italicizeOrBold(position,true,index,index + etAlString.length());
    }
  }
  position.collapseToEnd();
}
