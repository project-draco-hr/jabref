{
  String oldValue=entry.getField(GUIGlobals.FILE_FIELD);
  FileListTableModel tm=new FileListTableModel();
  if (oldValue != null)   tm.setContent(oldValue);
  if (avoidDuplicate) {
    String fileDir=panel.metaData().getFileDirectory(GUIGlobals.FILE_FIELD);
    String absFilename=(!(new File(filename).isAbsolute()) && (fileDir != null)) ? new File(fileDir,filename).getAbsolutePath() : filename;
    System.out.println("absFilename: " + absFilename);
    for (int i=0; i < tm.getRowCount(); i++) {
      FileListEntry flEntry=tm.getEntry(i);
      String absName=(!(new File(flEntry.getLink()).isAbsolute()) && (fileDir != null)) ? new File(fileDir,flEntry.getLink()).getAbsolutePath() : flEntry.getLink();
      System.out.println("absName: " + absName);
      if (absFilename.equals(absName))       return;
    }
  }
  tm.addEntry(tm.getRowCount(),new FileListEntry("",filename,fileType));
  String newValue=tm.getStringRepresentation();
  UndoableFieldChange edit=new UndoableFieldChange(entry,GUIGlobals.FILE_FIELD,oldValue,newValue);
  entry.setField(GUIGlobals.FILE_FIELD,newValue);
  if (edits == null) {
    panel.undoManager.addEdit(edit);
  }
 else {
    edits.addEdit(edit);
  }
}
