{
  try {
    BasePanel panel=OpenOfficePanel.frame.getCurrentBasePanel();
    if (panel != null) {
      final BibDatabase database=panel.database();
      BibEntry[] entries=panel.getSelectedEntries();
      ArrayList<BibEntry> el=new ArrayList<>();
      Collections.addAll(el,entries);
      BstWrapper wrapper=new BstWrapper();
      wrapper.loadBstFile(new File("/home/usr/share/texmf-tetex/bibtex/bst/ams/amsalpha.bst"));
      Map<String,String> result=wrapper.processEntries(el,database);
      for (      String key : result.keySet()) {
        System.out.println("Key: " + key);
        System.out.println("Entry: " + result.get(key));
        OpenOfficePanel.ooBase.insertMarkedUpTextAtViewCursor(result.get(key),"Default");
      }
    }
  }
 catch (  Exception ex) {
    ex.printStackTrace();
  }
}
