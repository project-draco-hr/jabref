{
  File file=new File(bibtexFile);
  File outFile=new File(outputFile);
  BibtexParser bparser=null;
  BibtexDatabase bibtex=null;
  PrintStream ps=null;
  try {
    FileInputStream fis=new FileInputStream(file);
    InputStreamReader reader=new InputStreamReader(fis);
    ps=new PrintStream(new FileOutputStream(outFile));
    bparser=new BibtexParser(reader);
    ParserResult pr=bparser.parse();
    bibtex=pr.getDatabase();
  }
 catch (  FileNotFoundException e) {
    e.printStackTrace();
  }
catch (  IOException e) {
    e.printStackTrace();
  }
  file=new File(layoutFile);
  try {
    FileInputStream fis=new FileInputStream(file);
    InputStreamReader reader=new InputStreamReader(fis);
    LayoutHelper layoutHelper=new LayoutHelper(reader);
    Layout layout=layoutHelper.getLayoutFromText();
    Object[] keys=bibtex.getKeySet().toArray();
    String key;
    for (int i=0; i < keys.length; i++) {
      key=(String)keys[i];
      BibtexEntry entry=bibtex.getEntryById(key);
      ps.println(layout.doLayout(entry));
    }
  }
 catch (  FileNotFoundException e) {
    e.printStackTrace();
  }
catch (  IOException e) {
    e.printStackTrace();
  }
}
