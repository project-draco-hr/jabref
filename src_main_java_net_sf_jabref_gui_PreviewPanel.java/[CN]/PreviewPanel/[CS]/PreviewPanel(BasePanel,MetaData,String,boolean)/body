{
  super(new BorderLayout(),true);
  withPDFPreview=withPDFPreview && JabRefPreferences.getInstance().getBoolean(JabRefPreferences.PDF_PREVIEW);
  this.metaData=Objects.requireNonNull(metaData);
  this.layoutFile=Objects.requireNonNull(layoutFile);
  updateLayout();
  this.closeAction=new CloseAction();
  this.printAction=new PrintAction();
  this.copyAction=new CopyAction();
  this.panel=Optional.ofNullable(panel);
  createPreviewPane();
  if (withPDFPreview) {
    this.pdfPreviewPanel=Optional.of(new PdfPreviewPanel(metaData));
  }
 else {
    this.pdfPreviewPanel=Optional.empty();
  }
  if (panel != null) {
    this.previewPane.setTransferHandler(new PreviewPanelTransferHandler(panel.frame(),this,this.previewPane.getTransferHandler()));
  }
  scrollPane=new JScrollPane(previewPane,ScrollPaneConstants.VERTICAL_SCROLLBAR_AS_NEEDED,ScrollPaneConstants.HORIZONTAL_SCROLLBAR_NEVER);
  scrollPane.setBorder(null);
  if (this.panel.isPresent() && JabRefPreferences.getInstance().getBoolean(JabRefPreferences.PREVIEW_PRINT_BUTTON)) {
    add(createToolBar(),BorderLayout.LINE_START);
  }
  if (withPDFPreview) {
    JSplitPane splitPane=new JSplitPane(JSplitPane.HORIZONTAL_SPLIT,scrollPane,pdfPreviewPanel.orElse(null));
    splitPane.setOneTouchExpandable(true);
    int oneThird=400;
    splitPane.setDividerLocation(oneThird * 2);
    add(splitPane);
  }
 else {
    add(scrollPane,BorderLayout.CENTER);
  }
}
