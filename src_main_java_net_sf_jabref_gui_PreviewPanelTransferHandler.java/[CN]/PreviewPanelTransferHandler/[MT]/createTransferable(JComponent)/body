{
  if (c instanceof JEditorPane) {
    JEditorPane e=(JEditorPane)c;
    StringWriter sw=new StringWriter();
    try {
      e.getEditorKit().write(sw,e.getDocument(),e.getSelectionStart(),e.getSelectionEnd());
    }
 catch (    IOException e1) {
      e1.printStackTrace();
    }
catch (    BadLocationException e1) {
      e1.printStackTrace();
    }
    return new HtmlTransferable(sw.toString(),e.getSelectedText());
  }
 else {
    return new StringSelection(Globals.lang("Operation not supported"));
  }
}
