{
  String s=input.toLowerCase();
  String[] words=s.split("\\s+");
  String[] result=new String[words.length];
  for (int i=0; i < words.length; i++) {
    String word=words[i];
    boolean alwaysCapitalizeFirstWord=i == 0;
    boolean alwaysCapitalizeLastWord=i == words.length - 1;
    if (alwaysCapitalizeFirstWord || alwaysCapitalizeLastWord) {
      result[i]=StringUtil.nCase(word);
    }
 else     if (TitleCaseChanger.notToCapitalize.contains(word)) {
      result[i]=word;
    }
 else {
      result[i]=StringUtil.nCase(word);
    }
  }
  return StringUtil.join(result,CaseChangers.SPACE_SEPARATOR);
}
