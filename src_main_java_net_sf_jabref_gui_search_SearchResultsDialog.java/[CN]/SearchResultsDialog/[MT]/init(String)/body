{
  diag=new JDialog(frame,title,false);
  int activePreview=Globals.prefs.getInt(JabRefPreferences.ACTIVE_PREVIEW);
  String layoutFile=activePreview == 0 ? Globals.prefs.get(JabRefPreferences.PREVIEW_0) : Globals.prefs.get(JabRefPreferences.PREVIEW_1);
  preview=new PreviewPanel(null,new MetaData(),layoutFile);
  sortedEntries=new SortedList<>(entries,new EntryComparator(false,true,"author"));
  model=(DefaultEventTableModel<BibEntry>)GlazedListsSwing.eventTableModelWithThreadProxyList(sortedEntries,new EntryTableFormat());
  entryTable=new JTable(model);
  GeneralRenderer renderer=new GeneralRenderer(Color.white);
  entryTable.setDefaultRenderer(JLabel.class,renderer);
  entryTable.setDefaultRenderer(String.class,renderer);
  setWidths();
  TableComparatorChooser<BibEntry> tableSorter=TableComparatorChooser.install(entryTable,sortedEntries,AbstractTableComparatorChooser.MULTIPLE_COLUMN_KEYBOARD);
  setupComparatorChooser(tableSorter);
  JScrollPane sp=new JScrollPane(entryTable);
  final DefaultEventSelectionModel<BibEntry> selectionModel=(DefaultEventSelectionModel<BibEntry>)GlazedListsSwing.eventSelectionModelWithThreadProxyList(sortedEntries);
  entryTable.setSelectionModel(selectionModel);
  selectionModel.getSelected().addListEventListener(new EntrySelectionListener());
  entryTable.addMouseListener(new TableClickListener());
  contentPane.setTopComponent(sp);
  contentPane.setBottomComponent(preview);
  AbstractAction closeAction=new AbstractAction(){
    @Override public void actionPerformed(    ActionEvent e){
      diag.dispose();
    }
  }
;
  ActionMap am=contentPane.getActionMap();
  InputMap im=contentPane.getInputMap(JComponent.WHEN_IN_FOCUSED_WINDOW);
  im.put(Globals.getKeyPrefs().getKey(KeyBinding.CLOSE_DIALOG),"close");
  am.put("close",closeAction);
  entryTable.getActionMap().put("copy",new AbstractAction(){
    @Override public void actionPerformed(    ActionEvent e){
      if (!selectionModel.getSelected().isEmpty()) {
        List<BibEntry> bes=selectionModel.getSelected();
        TransferableBibtexEntry trbe=new TransferableBibtexEntry(bes);
        Toolkit.getDefaultToolkit().getSystemClipboard().setContents(trbe,frame.getCurrentBasePanel());
        frame.output(Localization.lang("Copied") + ' ' + (bes.size() > 1 ? bes.size() + " " + Localization.lang("entries") : "1 " + Localization.lang("entry") + '.'));
      }
    }
  }
);
  diag.addWindowListener(new WindowAdapter(){
    @Override public void windowOpened(    WindowEvent e){
      contentPane.setDividerLocation(0.5f);
    }
    @Override public void windowClosing(    WindowEvent event){
      Globals.prefs.putInt(JabRefPreferences.SEARCH_DIALOG_WIDTH,diag.getSize().width);
      Globals.prefs.putInt(JabRefPreferences.SEARCH_DIALOG_HEIGHT,diag.getSize().height);
    }
  }
);
  diag.getContentPane().add(contentPane,BorderLayout.CENTER);
  diag.setSize(new Dimension(Globals.prefs.getInt(JabRefPreferences.SEARCH_DIALOG_WIDTH),Globals.prefs.getInt(JabRefPreferences.SEARCH_DIALOG_HEIGHT)));
  diag.setLocationRelativeTo(frame);
}
