{
  if (one.getType() != two.getType())   return false;
  String[] fields=one.getType().getRequiredFields();
  float req, reqWeight=2;
  if (fields == null) {
    req=0;
    reqWeight=0;
  }
 else   req=compareFieldSet(fields,one,two);
  fields=one.getType().getOptionalFields();
  if (fields != null) {
    float opt=compareFieldSet(fields,one,two);
    return (reqWeight * req + opt) / (1 + reqWeight) >= Globals.duplicateThreshold;
  }
 else {
    return (req >= Globals.duplicateThreshold);
  }
}
