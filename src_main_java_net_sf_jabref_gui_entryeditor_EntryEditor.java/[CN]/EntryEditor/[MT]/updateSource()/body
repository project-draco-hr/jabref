{
  if (updateSource) {
    StringWriter stringWriter=new StringWriter(200);
    try {
      LatexFieldFormatter formatter=LatexFieldFormatter.buildIgnoreHashes();
      entry.write(stringWriter,formatter,false);
      String srcString=stringWriter.getBuffer().toString();
      source.setText(srcString);
      lastSourceStringAccepted=srcString;
      SwingUtilities.invokeLater(new Runnable(){
        @Override public void run(){
          final int row=panel.mainTable.findEntry(entry);
          if (row >= 0) {
            if (panel.mainTable.getSelectedRowCount() == 0) {
              panel.mainTable.setRowSelectionInterval(row,row);
            }
            panel.mainTable.ensureVisible(row);
          }
        }
      }
);
    }
 catch (    IOException ex) {
      source.setText(ex.getMessage() + "\n\n" + Localization.lang("Correct the entry, and " + "reopen editor to display/edit source."));
      source.setEditable(false);
    }
  }
}
