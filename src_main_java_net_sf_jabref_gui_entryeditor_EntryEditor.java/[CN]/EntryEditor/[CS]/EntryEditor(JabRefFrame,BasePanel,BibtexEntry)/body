{
  frame=frame_;
  panel=panel_;
  entry=entry_;
  prefs=Globals.prefs;
  type=entry.getType();
  entry.addPropertyChangeListener(this);
  entry.addPropertyChangeListener(SpecialFieldUpdateListener.getInstance());
  helpAction=new HelpAction(frame.helpDiag,GUIGlobals.entryEditorHelp,"Help");
  closeAction=new CloseAction();
  generateKeyAction=new GenerateKeyAction(frame);
  storeFieldAction=new StoreFieldAction();
  writeXmp=new WriteXMPEntryEditorAction(panel_,this);
  BorderLayout bl=new BorderLayout();
  setLayout(bl);
  setupToolBar();
  setupFieldPanels();
  setupSourcePanel();
  add(tabbed,BorderLayout.CENTER);
  tabbed.addChangeListener(tabListener);
  if (prefs.getBoolean(JabRefPreferences.SHOW_SOURCE) && prefs.getBoolean(JabRefPreferences.DEFAULT_SHOW_SOURCE)) {
    tabbed.setSelectedIndex(sourceIndex);
  }
  updateAllFields();
}
