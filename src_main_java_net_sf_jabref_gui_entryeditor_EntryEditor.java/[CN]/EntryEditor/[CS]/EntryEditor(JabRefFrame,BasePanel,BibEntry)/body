{
  this.frame=frame;
  this.panel=panel;
  this.entry=entry;
  prefs=Globals.prefs;
  this.entry.addPropertyChangeListener(this);
  this.entry.addPropertyChangeListener(SpecialFieldUpdateListener.getInstance());
  helpAction=new HelpAction(this.frame.helpDiag,GUIGlobals.entryEditorHelp,IconTheme.JabRefIcon.HELP.getIcon());
  closeAction=new CloseAction();
  generateKeyAction=new GenerateKeyAction();
  storeFieldAction=new StoreFieldAction();
  writeXmp=new WriteXMPEntryEditorAction(panel,this);
  BorderLayout borderLayout=new BorderLayout();
  setLayout(borderLayout);
  setupToolBar();
  setupFieldPanels();
  setupSourcePanel();
  add(tabbed,BorderLayout.CENTER);
  tabbed.addChangeListener(tabListener);
  if (prefs.getBoolean(JabRefPreferences.DEFAULT_SHOW_SOURCE)) {
    tabbed.setSelectedIndex(sourceIndex);
  }
  updateAllFields();
}
