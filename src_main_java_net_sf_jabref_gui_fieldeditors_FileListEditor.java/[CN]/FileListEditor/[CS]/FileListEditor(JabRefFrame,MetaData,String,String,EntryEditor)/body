{
  this.frame=frame;
  this.metaData=metaData;
  this.fieldName=fieldName;
  this.entryEditor=entryEditor;
  label=new FieldNameLabel(" " + StringUtil.capitalizeFirst(fieldName) + " ");
  tableModel=new FileListTableModel();
  setText(content);
  setModel(tableModel);
  JScrollPane sPane=new JScrollPane(this);
  setTableHeader(null);
  addMouseListener(new TableClickListener());
  JButton add=new JButton(IconTheme.JabRefIcon.ADD_NOBOX.getSmallIcon());
  add.setToolTipText(Localization.lang("New file link (INSERT)"));
  JButton remove=new JButton(IconTheme.JabRefIcon.REMOVE_NOBOX.getSmallIcon());
  remove.setToolTipText(Localization.lang("Remove file link (DELETE)"));
  JButton up=new JButton(IconTheme.JabRefIcon.UP.getSmallIcon());
  JButton down=new JButton(IconTheme.JabRefIcon.DOWN.getSmallIcon());
  auto=new JButton(Localization.lang("Auto"));
  JButton download=new JButton(Localization.lang("Download"));
  add.setMargin(new Insets(0,0,0,0));
  remove.setMargin(new Insets(0,0,0,0));
  up.setMargin(new Insets(0,0,0,0));
  down.setMargin(new Insets(0,0,0,0));
  add.addActionListener(new ActionListener(){
    @Override public void actionPerformed(    ActionEvent e){
      addEntry();
    }
  }
);
  remove.addActionListener(new ActionListener(){
    @Override public void actionPerformed(    ActionEvent e){
      removeEntries();
    }
  }
);
  up.addActionListener(new ActionListener(){
    @Override public void actionPerformed(    ActionEvent e){
      moveEntry(-1);
    }
  }
);
  down.addActionListener(new ActionListener(){
    @Override public void actionPerformed(    ActionEvent e){
      moveEntry(1);
    }
  }
);
  auto.addActionListener(new ActionListener(){
    @Override public void actionPerformed(    ActionEvent e){
      autoSetLinks();
    }
  }
);
  download.addActionListener(new ActionListener(){
    @Override public void actionPerformed(    ActionEvent e){
      downloadFile();
    }
  }
);
  FormBuilder builder=FormBuilder.create().layout(new FormLayout("fill:pref,1dlu,fill:pref,1dlu,fill:pref","fill:pref,fill:pref"));
  builder.add(up).xy(1,1);
  builder.add(add).xy(3,1);
  builder.add(auto).xy(5,1);
  builder.add(down).xy(1,2);
  builder.add(remove).xy(3,2);
  builder.add(download).xy(5,2);
  panel=new JPanel();
  panel.setLayout(new BorderLayout());
  panel.add(sPane,BorderLayout.CENTER);
  panel.add(builder.getPanel(),BorderLayout.EAST);
  TransferHandler transferHandler=new FileListEditorTransferHandler(frame,entryEditor,null);
  setTransferHandler(transferHandler);
  panel.setTransferHandler(transferHandler);
  getInputMap().put(KeyStroke.getKeyStroke("DELETE"),"delete");
  getActionMap().put("delete",new AbstractAction(){
    @Override public void actionPerformed(    ActionEvent actionEvent){
      int row=getSelectedRow();
      removeEntries();
      row=Math.min(row,getRowCount() - 1);
      if (row >= 0) {
        setRowSelectionInterval(row,row);
      }
    }
  }
);
  getInputMap().put(KeyStroke.getKeyStroke("INSERT"),"insert");
  getActionMap().put("insert",new AbstractAction(){
    @Override public void actionPerformed(    ActionEvent actionEvent){
      addEntry();
    }
  }
);
  getInputMap().put(Globals.prefs.getKey("File list editor, move entry up"),"move up");
  getActionMap().put("move up",new AbstractAction(){
    @Override public void actionPerformed(    ActionEvent actionEvent){
      moveEntry(-1);
    }
  }
);
  getInputMap().put(Globals.prefs.getKey("File list editor, move entry down"),"move down");
  getActionMap().put("move down",new AbstractAction(){
    @Override public void actionPerformed(    ActionEvent actionEvent){
      moveEntry(1);
    }
  }
);
  JMenuItem openLink=new JMenuItem(Localization.lang("Open"));
  menu.add(openLink);
  openLink.addActionListener(new ActionListener(){
    @Override public void actionPerformed(    ActionEvent actionEvent){
      openSelectedFile();
    }
  }
);
  JMenuItem openFolder=new JMenuItem(Localization.lang("Open folder"));
  menu.add(openFolder);
  openFolder.addActionListener(new ActionListener(){
    @Override public void actionPerformed(    ActionEvent e){
      int row=getSelectedRow();
      if (row >= 0) {
        FileListEntry entry=tableModel.getEntry(row);
        try {
          JabRefDesktop.openFolderAndSelectFile(entry.getLink());
        }
 catch (        IOException ex) {
          LOGGER.debug("Cannot open folder",ex);
        }
      }
    }
  }
);
  JMenuItem rename=new JMenuItem(Localization.lang("Move/Rename file"));
  menu.add(rename);
  rename.addActionListener(new MoveFileAction(frame,entryEditor,this,false));
  JMenuItem moveToFileDir=new JMenuItem(Localization.lang("Move to file directory"));
  menu.add(moveToFileDir);
  moveToFileDir.addActionListener(new MoveFileAction(frame,entryEditor,this,true));
  JMenuItem deleteFile=new JMenuItem(Localization.lang("Delete local file"));
  menu.add(deleteFile);
  deleteFile.addActionListener(new ActionListener(){
    @Override public void actionPerformed(    ActionEvent e){
      int row=getSelectedRow();
      if (row == -1) {
        return;
      }
      FileListEntry entry=tableModel.getEntry(row);
      File file=FileUtil.expandFilename(metaData,entry.getLink());
      try {
        if (file != null) {
          Files.delete(file.toPath());
        }
        removeEntries();
      }
 catch (      IOException ex) {
        JOptionPane.showMessageDialog(frame,Localization.lang("File permission error"),Localization.lang("Cannot delete file"),JOptionPane.ERROR_MESSAGE);
        LOGGER.warn("File permission error while deleting: " + file.toPath(),ex);
      }
    }
  }
);
}
