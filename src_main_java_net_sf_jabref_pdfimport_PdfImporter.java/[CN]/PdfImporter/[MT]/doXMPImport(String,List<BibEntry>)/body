{
  BibEntry entry;
  List<BibEntry> localRes=null;
  PdfXmpImporter importer=new PdfXmpImporter();
  try (InputStream in=new FileInputStream(fileName)){
    localRes=importer.importEntries(in,frame);
  }
 catch (  IOException ex) {
    LOGGER.warn("Cannot import entries",ex);
  }
  if ((localRes == null) || localRes.isEmpty()) {
    LOGGER.info("Import failed");
    entry=createNewBlankEntry(fileName);
    res.add(entry);
    return;
  }
  entry=localRes.get(0);
  panel.database().insertEntry(entry);
  panel.markBaseChanged();
  FileListTableModel tm=new FileListTableModel();
  File toLink=new File(fileName);
  List<String> dirsS=panel.getBibDatabaseContext().getMetaData().getFileDirectory(Globals.FILE_FIELD);
  tm.addEntry(0,new FileListEntry(toLink.getName(),FileUtil.shortenFileName(toLink,dirsS).getPath(),ExternalFileTypes.getInstance().getExternalFileTypeByName("pdf")));
  entry.setField(Globals.FILE_FIELD,tm.getStringRepresentation());
  res.add(entry);
}
