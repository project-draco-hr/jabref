{
  this.forceLowerCase=forceLowerCase;
  add=new JButton(Globals.lang(addText));
  remove=new JButton(Globals.lang(removeText));
  listModel=new DefaultListModel<String>();
  if (title != null)   this.title=new JLabel(title);
  for (  String field : fields)   listModel.addElement(field);
  list=new JList<String>(listModel);
  list.setSelectionMode(ListSelectionModel.MULTIPLE_INTERVAL_SELECTION);
  add.addActionListener(this);
  remove.addActionListener(this);
  setLayout(gbl);
  con.insets=new Insets(1,1,1,1);
  con.fill=GridBagConstraints.BOTH;
  con.weightx=1;
  con.gridwidth=GridBagConstraints.REMAINDER;
  if (this.title != null) {
    gbl.setConstraints(this.title,con);
    add(this.title);
  }
  con.weighty=1;
  sp=new JScrollPane(list,JScrollPane.VERTICAL_SCROLLBAR_AS_NEEDED,JScrollPane.HORIZONTAL_SCROLLBAR_NEVER);
  gbl.setConstraints(sp,con);
  add(sp);
  con.weighty=0;
  con.gridwidth=1;
  if (arrows) {
    con.weightx=0;
    up=new JButton(GUIGlobals.getImage("up"));
    down=new JButton(GUIGlobals.getImage("down"));
    up.addActionListener(this);
    down.addActionListener(this);
    up.setToolTipText(Globals.lang("Move up"));
    down.setToolTipText(Globals.lang("Move down"));
    gbl.setConstraints(up,con);
    add(up);
    gbl.setConstraints(down,con);
    add(down);
    con.weightx=0;
  }
  Component strut=Box.createHorizontalStrut(5);
  gbl.setConstraints(strut,con);
  add(strut);
  con.weightx=1;
  con.gridwidth=GridBagConstraints.REMAINDER;
  con.gridwidth=GridBagConstraints.REMAINDER;
  gbl.setConstraints(remove,con);
  add(remove);
  con.gridwidth=3;
  con.weightx=1;
  if (preset != null) {
    sel=new JComboBox<String>(preset.toArray(new String[preset.size()]));
    sel.setEditable(true);
    gbl.setConstraints(sel,con);
    add(sel);
  }
 else {
    input=new JTextField(20);
    input.addActionListener(this);
    gbl.setConstraints(input,con);
    add(input);
  }
  con.gridwidth=GridBagConstraints.REMAINDER;
  con.weighty=0;
  con.weightx=0.5;
  con.gridwidth=1;
  gbl.setConstraints(add,con);
  add(add);
}
