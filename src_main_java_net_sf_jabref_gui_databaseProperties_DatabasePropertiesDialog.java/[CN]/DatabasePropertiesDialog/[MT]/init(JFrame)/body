{
  JButton browseFile=new JButton(Localization.lang("Browse"));
  JButton browseFileIndv=new JButton(Localization.lang("Browse"));
  browseFile.addActionListener(BrowseAction.buildForDir(parent,fileDir));
  browseFileIndv.addActionListener(BrowseAction.buildForDir(parent,fileDirIndv));
  setupSortOrderConfiguration();
  FormBuilder builder=FormBuilder.create().layout(new FormLayout("left:pref, 4dlu, left:pref, 4dlu, pref:grow","pref, 2dlu, pref, 2dlu, pref, 2dlu, pref, 2dlu, pref, 2dlu, pref, 2dlu, pref, 2dlu, pref, 2dlu, pref, 2dlu, pref, 2dlu, pref, 2dlu, pref, 2dlu, pref, 2dlu, pref, 2dlu, pref, 135dlu, pref,"));
  builder.getPanel().setBorder(BorderFactory.createEmptyBorder(5,5,5,5));
  builder.add(Localization.lang("Database encoding")).xy(1,1);
  builder.add(encoding).xy(3,1);
  builder.addSeparator(Localization.lang("Override default file directories")).xyw(1,3,5);
  builder.add(Localization.lang("General file directory")).xy(1,5);
  builder.add(fileDir).xy(3,1);
  builder.add(browseFile).xy(5,5);
  builder.add(Localization.lang("User-specific file directory")).xy(1,7);
  builder.add(fileDirIndv).xy(3,7);
  builder.add(browseFileIndv).xy(5,7);
  builder.addSeparator(Localization.lang("Save sort order")).xyw(1,13,5);
  builder.add(saveInOriginalOrder).xyw(1,15,5);
  builder.add(saveInSpecifiedOrder).xyw(1,17,5);
  saveOrderPanel=new SaveOrderConfigDisplay();
  builder.add(saveOrderPanel.getPanel()).xyw(1,21,5);
  builder.addSeparator(Localization.lang("Database protection")).xyw(1,23,5);
  builder.add(protect).xyw(1,25,5);
  saveActionsPanel=new SaveActionsPanel();
  builder.addSeparator(Localization.lang("Save actions")).xyw(1,27,5);
  builder.add(saveActionsPanel).xyw(1,29,5);
  ButtonBarBuilder bb=new ButtonBarBuilder();
  bb.addGlue();
  bb.addButton(ok);
  bb.addButton(cancel);
  bb.addGlue();
  getContentPane().add(builder.getPanel(),BorderLayout.CENTER);
  getContentPane().add(bb.getPanel(),BorderLayout.SOUTH);
  pack();
  AbstractAction closeAction=new AbstractAction(){
    @Override public void actionPerformed(    ActionEvent e){
      dispose();
    }
  }
;
  ActionMap am=builder.getPanel().getActionMap();
  InputMap im=builder.getPanel().getInputMap(JComponent.WHEN_IN_FOCUSED_WINDOW);
  im.put(Globals.getKeyPrefs().getKey(KeyBinding.CLOSE_DIALOG),"close");
  am.put("close",closeAction);
  ok.addActionListener(new ActionListener(){
    @Override public void actionPerformed(    ActionEvent e){
      storeSettings();
      dispose();
    }
  }
);
  cancel.addActionListener(new ActionListener(){
    @Override public void actionPerformed(    ActionEvent e){
      dispose();
    }
  }
);
}
