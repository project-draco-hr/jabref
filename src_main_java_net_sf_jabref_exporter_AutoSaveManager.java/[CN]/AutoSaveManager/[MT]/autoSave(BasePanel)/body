{
  File databaseFile=panel.getLoadedDatabase().getDatabaseFile();
  File backupFile=AutoSaveManager.getAutoSaveFile(databaseFile);
  try {
    SaveSession ss=FileActions.saveDatabase(new LoadedDatabase(panel.database(),panel.loadedDatabase.getMetaData(),backupFile),Globals.prefs,false,false,panel.getEncoding(),true);
    ss.commit();
  }
 catch (  SaveException e) {
    e.printStackTrace();
    return false;
  }
catch (  Throwable ex) {
    ex.printStackTrace();
    return false;
  }
 finally {
    panel.loadedDatabase.getMetaData().setFile(databaseFile);
  }
  return true;
}
