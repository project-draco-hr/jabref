{
  if (type == LayoutHelper.IS_LAYOUT_TEXT) {
    return text;
  }
 else   if (type == LayoutHelper.IS_SIMPLE_FIELD) {
    throw new UnsupportedOperationException("bibtex entry fields not allowed in begin or end layout");
  }
 else   if ((type == LayoutHelper.IS_FIELD_START) || (type == LayoutHelper.IS_GROUP_START)) {
    throw new UnsupportedOperationException("field and group starts not allowed in begin or end layout");
  }
 else   if ((type == LayoutHelper.IS_FIELD_END) || (type == LayoutHelper.IS_GROUP_END)) {
    throw new UnsupportedOperationException("field and group ends not allowed in begin or end layout");
  }
 else   if (type == LayoutHelper.IS_OPTION_FIELD) {
    String field=BibtexDatabase.getText(text,database);
    if (option != null) {
      for (int i=0; i < option.length; i++) {
        field=option[i].format(field);
      }
    }
    return field;
  }
 else   if (type == LayoutHelper.IS_ENCODING_NAME) {
    String commonName=Globals.ENCODING_NAMES_LOOKUP.get(encoding);
    return commonName != null ? commonName : encoding;
  }
  return "";
}
