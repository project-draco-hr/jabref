{
  int score=0;
  Iterator e=searchStrings.values().iterator();
  String searchString=(String)e.next();
  if (!searchString.matches("\\.\\*")) {
    searchString=".*" + searchString + ".*";
  }
  String tempString=null;
  int flags=0;
  if (!prefs.getBoolean("caseSensitiveSearch"))   flags=Pattern.CASE_INSENSITIVE;
  Pattern pattern=Pattern.compile(searchString,flags);
  if (prefs.getBoolean("searchAll")) {
    Object[] fields=bibtexEntry.getAllFields();
    score+=searchFields(fields,bibtexEntry,pattern);
  }
 else {
    if (prefs.getBoolean("searchReq")) {
      String[] requiredField=bibtexEntry.getRequiredFields();
      score+=searchFields(requiredField,bibtexEntry,pattern);
    }
    if (prefs.getBoolean("searchOpt")) {
      String[] optionalField=bibtexEntry.getOptionalFields();
      score+=searchFields(optionalField,bibtexEntry,pattern);
    }
    if (prefs.getBoolean("searchGen")) {
      String[] generalField=bibtexEntry.getGeneralFields();
      score+=searchFields(generalField,bibtexEntry,pattern);
    }
  }
  return score;
}
