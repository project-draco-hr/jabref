{
  if (e.getValueIsAdjusting()) {
    return;
  }
  if (lastSelected != null) {
    reqLists.put(lastSelected,reqComp.getFields());
    optLists.put(lastSelected,optComp.getFields());
    if (biblatexMode) {
      opt2Lists.put(lastSelected,optComp2.getFields());
    }
  }
  String s=typeComp.getFirstSelected();
  if (s == null) {
    return;
  }
  List<String> rl=reqLists.get(s);
  if (rl == null) {
    BibtexEntryType type=BibtexEntryType.getType(s);
    if (type != null) {
      List<String> req=type.getRequiredFieldsForCustomization();
      List<String> opt;
      if (!biblatexMode) {
        opt=type.getOptionalFields();
      }
 else {
        opt=type.getPrimaryOptionalFields();
        List<String> opt2=type.getSecondaryOptionalFields();
        optComp2.setFields(opt2);
        optComp2.setEnabled(true);
      }
      reqComp.setFields(req);
      reqComp.setEnabled(true);
      optComp.setFields(opt);
      optComp.setEnabled(true);
    }
 else {
      reqComp.setFields(new ArrayList<String>());
      reqComp.setEnabled(true);
      optComp.setFields(new ArrayList<String>());
      optComp.setEnabled(true);
      if (biblatexMode) {
        optComp2.setFields(new ArrayList<String>());
        optComp2.setEnabled(true);
      }
      new FocusRequester(reqComp);
    }
  }
 else {
    reqComp.setFields(rl);
    optComp.setFields(optLists.get(s));
    if (biblatexMode) {
      optComp2.setFields(opt2Lists.get(s));
    }
  }
  lastSelected=s;
  typeComp.enable(s,changed.contains(lastSelected) && !defaulted.contains(lastSelected));
}
