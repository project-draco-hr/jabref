{
  OpenDatabaseAction openAction=new OpenDatabaseAction(frame,false);
  ArrayList<String> notBibFiles=new ArrayList<String>();
  String encoding=Globals.prefs.get("defaultEncoding");
  for (  String fileName : fileNames) {
    String extension="";
    ExternalFileType fileType=null;
    int index=fileName.lastIndexOf('.');
    if ((index >= 0) && (index < fileName.length())) {
      extension=fileName.substring(index + 1).toLowerCase();
      fileType=Globals.prefs.getExternalFileTypeByExt(extension);
    }
    if (extension.equals("bib")) {
      File f=new File(fileName);
      try {
        ParserResult pr=OpenDatabaseAction.loadDatabase(f,encoding);
        if ((pr == null) || (pr == ParserResult.INVALID_FORMAT)) {
          notBibFiles.add(fileName);
        }
 else {
          openAction.addNewDatabase(pr,f,true);
          frame.getFileHistory().newFile(fileName);
        }
      }
 catch (      IOException e) {
        notBibFiles.add(fileName);
      }
      continue;
    }
    if ((fileType != null) && (dropRow >= 0)) {
      boolean local=true;
      DroppedFileHandler dfh=new DroppedFileHandler(frame,panel);
      dfh.handleDroppedfile(fileName,fileType,local,entryTable,dropRow);
      continue;
    }
    notBibFiles.add(fileName);
  }
  if (notBibFiles.size() > 0) {
    String[] toImport=new String[notBibFiles.size()];
    notBibFiles.toArray(toImport);
    ImportMenuItem importer=new ImportMenuItem(frame,(entryTable == null));
    importer.automatedImport(toImport);
  }
}
