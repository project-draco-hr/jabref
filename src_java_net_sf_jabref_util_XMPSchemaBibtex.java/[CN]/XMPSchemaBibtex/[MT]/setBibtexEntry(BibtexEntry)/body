{
  Object[] fields=entry.getAllFields();
  Object[] results;
  int resultsSize;
  JabRefPreferences prefs=JabRefPreferences.getInstance();
  if (prefs.getBoolean("useXmpPrivacyFilter")) {
    TreeSet filters=new TreeSet(Arrays.asList(prefs.getStringArray("xmpPrivacyFilter")));
    results=new Object[fields.length];
    resultsSize=0;
    for (int i=0; i < fields.length; i++) {
      if (!filters.contains(fields[i])) {
        results[resultsSize++]=fields[i];
      }
    }
  }
 else {
    results=fields;
    resultsSize=fields.length;
  }
  for (int i=0; i < resultsSize; i++) {
    String s=results[i].toString();
    if (s.equals("author") || s.equals("editor")) {
      setPersonList(s,entry.getField(s).toString());
    }
 else {
      setTextProperty(s,entry.getField(s).toString());
    }
  }
  setTextProperty("entrytype",entry.getType().getName());
}
