{
  HashMap<BibtexEntry,List<File>> result=new HashMap<BibtexEntry,List<File>>();
  Set<File> filesWithExtension=findFiles(extensions,directories);
  for (  BibtexEntry entry : entries) {
    result.put(entry,new ArrayList<File>());
  }
  boolean exactOnly=Globals.prefs.getBoolean("autolinkExactKeyOnly");
  nextFile:   for (  File file : filesWithExtension) {
    String name=file.getName();
    int dot=name.lastIndexOf('.');
    for (    BibtexEntry entry : entries) {
      String citeKey=entry.getCiteKey();
      if ((citeKey != null) && (citeKey.length() > 0)) {
        if (dot > 0) {
          if (name.substring(0,dot).equals(citeKey)) {
            result.get(entry).add(file);
            continue nextFile;
          }
        }
      }
    }
    if (!exactOnly) {
      for (      BibtexEntry entry : entries) {
        String citeKey=entry.getCiteKey();
        if ((citeKey != null) && (citeKey.length() > 0)) {
          if (name.startsWith(citeKey)) {
            result.get(entry).add(file);
            continue nextFile;
          }
        }
      }
    }
  }
  return result;
}
