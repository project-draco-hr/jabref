{
  if (fileName == null || fileName.length() == 0)   return fileName;
  if (!fileName.isAbsolute() || dir == null)   return fileName;
  String longName;
  if (Globals.ON_WIN) {
    longName=fileName.toString().toLowerCase();
    dir=dir.toLowerCase();
  }
 else {
    longName=fileName.toString();
  }
  if (!dir.endsWith(System.getProperty("file.separator")))   dir=dir.concat(System.getProperty("file.separator"));
  if (longName.toString().startsWith(dir)) {
    String newName=fileName.toString().substring(dir.length());
    return new File(newName);
  }
 else {
    return fileName;
  }
}
