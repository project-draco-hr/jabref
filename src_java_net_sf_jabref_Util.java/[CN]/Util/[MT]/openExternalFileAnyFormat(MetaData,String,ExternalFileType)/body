{
  boolean httpLink=remoteLinkPattern.matcher(link.toLowerCase()).matches();
  if (link.toLowerCase().startsWith("file://")) {
    httpLink=false;
    link=link.substring(7);
  }
  File file=new File(link);
  String name=file.getName();
  int pos=name.lastIndexOf('.');
  String extension=((pos >= 0) && (pos < name.length() - 1)) ? name.substring(pos + 1).trim().toLowerCase() : null;
  String dir=metaData.getFileDirectory(extension);
  String fileDir=metaData.getFileDirectory(GUIGlobals.FILE_FIELD);
  String[] dirs;
  if (metaData.getFile() != null) {
    String databaseDir=metaData.getFile().getParent();
    dirs=new String[]{dir,fileDir,databaseDir};
  }
 else   dirs=new String[]{dir,fileDir};
  if (!httpLink) {
    File tmp=expandFilename(link,dirs);
    if (tmp != null)     file=tmp;
  }
  if ((httpLink || file.exists()) && (fileType != null)) {
    try {
      String filePath=httpLink ? link : file.getPath();
      if (Globals.ON_MAC) {
        String[] cmd=((fileType.getOpenWith() != null) && (fileType.getOpenWith().length() > 0)) ? new String[]{"/usr/bin/open","-a",fileType.getOpenWith(),filePath} : new String[]{"/usr/bin/open",filePath};
        Runtime.getRuntime().exec(cmd);
      }
 else       if (Globals.ON_WIN) {
        if ((fileType.getOpenWith() != null) && (fileType.getOpenWith().length() > 0)) {
          openFileWithApplicationOnWindows(filePath,fileType.getOpenWith());
        }
 else         openFileOnWindows(filePath,true);
      }
 else {
        String[] openWith;
        if ((fileType.getOpenWith() != null) && (fileType.getOpenWith().length() > 0))         openWith=fileType.getOpenWith().split(" ");
 else         openWith=new String[]{"xdg-open"};
        String[] cmdArray=new String[openWith.length + 1];
        System.arraycopy(openWith,0,cmdArray,0,openWith.length);
        cmdArray[cmdArray.length - 1]=filePath;
        Runtime.getRuntime().exec(cmdArray);
      }
      return true;
    }
 catch (    IOException e) {
      throw e;
    }
  }
 else {
    return false;
  }
}
