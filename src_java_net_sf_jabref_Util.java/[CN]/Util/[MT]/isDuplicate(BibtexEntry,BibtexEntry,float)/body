{
  if (one.getType() != two.getType())   return false;
  String[] fields=one.getType().getRequiredFields();
  if (fields == null)   return false;
  float req=compareFieldSet(fields,one,two);
  fields=one.getType().getOptionalFields();
  float opt=compareFieldSet(fields,one,two);
  return (2 * req + opt) / 3 >= threshold;
}
