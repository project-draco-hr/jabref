{
  Object o=be.getField(BibtexFields.MARKED);
  if (o != null) {
    String s=o.toString();
    if (s.equals("0")) {
      unmarkOldStyle(be,database,ce);
      return;
    }
    int piv=0, hit;
    StringBuffer sb=new StringBuffer();
    while ((hit=s.indexOf(Globals.prefs.WRAPPED_USERNAME,piv)) >= 0) {
      if (hit > 0)       sb.append(s.substring(piv,hit));
      piv=hit + Globals.prefs.WRAPPED_USERNAME.length();
    }
    if (piv < s.length() - 1) {
      sb.append(s.substring(piv));
    }
    String newVal=sb.length() > 0 ? sb.toString() : null;
    ce.addEdit(new UndoableFieldChange(be,BibtexFields.MARKED,be.getField(BibtexFields.MARKED),newVal));
    be.setField(BibtexFields.MARKED,newVal);
  }
}
