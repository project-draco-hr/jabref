{
  PDDocument document=null;
  try {
    document=PDDocument.load(inputStream);
    if (document.isEncrypted()) {
      throw new EncryptionNotSupportedException("Error: Cannot read metadata from encrypted document.");
    }
    return XMPUtil.getXMPMetadata(document);
  }
  finally {
    if (document != null) {
      document.close();
    }
  }
}
