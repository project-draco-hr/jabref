{
  if (flavor.equals(entryFlavor))   return data;
 else   if (flavor.equals(DataFlavor.stringFlavor)) {
    try {
      StringWriter sw=new StringWriter();
      BibtexEntryWriter bibtexEntryWriter=new BibtexEntryWriter(new LatexFieldFormatter(),false);
      for (      BibtexEntry entry : data) {
        bibtexEntryWriter.write(entry,sw);
      }
      return sw.toString();
    }
 catch (    IOException ex) {
      JOptionPane.showMessageDialog(null,"Could not paste entry as text:\n" + ex.getMessage(),"Clipboard",JOptionPane.ERROR_MESSAGE);
      return "";
    }
  }
 else   throw new UnsupportedFlavorException(flavor);
}
