{
  List rewrites=getProgram(programName);
  if (op.index >= getLastRewriteTokenIndex(programName)) {
    rewrites.add(op);
    setLastRewriteTokenIndex(programName,op.index);
    return;
  }
  Comparator comparator=new Comparator(){
    public int compare(    Object o,    Object o1){
      RewriteOperation a=(RewriteOperation)o;
      RewriteOperation b=(RewriteOperation)o1;
      if (a.index < b.index)       return -1;
      if (a.index > b.index)       return 1;
      return 0;
    }
  }
;
  int pos=Collections.binarySearch(rewrites,op,comparator);
  if (pos < 0) {
    rewrites.add(-pos - 1,op);
  }
}
