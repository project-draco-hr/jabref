{
  File initValue=new File(Globals.prefs.get("ooStyleFileLastDir"));
  JFileChooser jfc=new JFileChooser(initValue);
  if (directory)   jfc.setFileSelectionMode(JFileChooser.DIRECTORIES_ONLY);
 else {
    if (styleFileFilter == null) {
      styleFileFilter=new FileFilter(){
        public boolean accept(        File file){
          return file.isDirectory() || file.getName().endsWith(StyleSelectDialog.STYLE_FILE_EXTENSION);
        }
        public String getDescription(){
          return StyleSelectDialog.STYLE_FILE_EXTENSION;
        }
      }
;
    }
    jfc.addChoosableFileFilter(styleFileFilter);
  }
  if (jfc.showOpenDialog(parent) == JFileChooser.APPROVE_OPTION) {
    Globals.prefs.put("ooStyleFileLastDir",jfc.getSelectedFile().getPath());
    DirElement elm=new DirElement(jfc.getSelectedFile().getPath(),false,directory);
    entries.getReadWriteLock().writeLock().lock();
    if (!entries.contains(elm))     entries.add(elm);
    entries.getReadWriteLock().writeLock().unlock();
    notifyListeners();
  }
}
