{
  super(frame);
  this.frame=frame;
  this.panel=panel;
  this.base=base;
  this.prefs=prefs;
  sortStrings();
  helpAction=new HelpAction(frame.helpDiag,GUIGlobals.stringEditorHelp,Localization.lang("Help"));
  addWindowListener(new WindowAdapter(){
    @Override public void windowClosing(    WindowEvent e){
      closeAction.actionPerformed(null);
    }
  }
);
  setFocusTraversalPolicy(new LayoutFocusTraversalPolicy(){
    @Override protected boolean accept(    Component c){
      return super.accept(c) && c instanceof StringTable;
    }
  }
);
  setLocation(prefs.getInt(JabRefPreferences.STRINGS_POS_X),prefs.getInt(JabRefPreferences.STRINGS_POS_Y));
  setSize(prefs.getInt(JabRefPreferences.STRINGS_SIZE_X),prefs.getInt(JabRefPreferences.STRINGS_SIZE_Y));
  JPanel pan=new JPanel();
  GridBagLayout gbl=new GridBagLayout();
  pan.setLayout(gbl);
  GridBagConstraints con=new GridBagConstraints();
  con.fill=GridBagConstraints.BOTH;
  con.weighty=1;
  con.weightx=1;
  StringTableModel stm=new StringTableModel(this,base);
  table=new StringTable(stm);
  if (base.getStringCount() > 0) {
    table.setRowSelectionInterval(0,0);
  }
  gbl.setConstraints(table.getPane(),con);
  pan.add(table.getPane());
  JToolBar tlb=new JToolBar();
  InputMap im=tlb.getInputMap(JComponent.WHEN_IN_FOCUSED_WINDOW);
  ActionMap am=tlb.getActionMap();
  im.put(prefs.getKey("String dialog, add string"),"add");
  NewStringAction newStringAction=new NewStringAction(this);
  am.put("add",newStringAction);
  im.put(prefs.getKey("String dialog, remove string"),"remove");
  RemoveStringAction removeStringAction=new RemoveStringAction(this);
  am.put("remove",removeStringAction);
  im.put(prefs.getKey("Close dialog"),"close");
  am.put("close",closeAction);
  im.put(prefs.getKey("Help"),"help");
  am.put("help",helpAction);
  im.put(prefs.getKey("Undo"),"undo");
  UndoAction undoAction=new UndoAction();
  am.put("undo",undoAction);
  im.put(prefs.getKey("Redo"),"redo");
  RedoAction redoAction=new RedoAction();
  am.put("redo",redoAction);
  tlb.add(newStringAction);
  tlb.add(removeStringAction);
  tlb.addSeparator();
  tlb.addSeparator();
  tlb.add(helpAction);
  Container conPane=getContentPane();
  conPane.add(tlb,BorderLayout.NORTH);
  conPane.add(pan,BorderLayout.CENTER);
  if (panel.getFile() != null) {
    setTitle(Localization.lang(GUIGlobals.stringsTitle) + ": " + panel.getFile().getName());
  }
 else {
    setTitle(Localization.lang(GUIGlobals.stringsTitle) + ": " + Localization.lang(GUIGlobals.untitledTitle));
  }
}
