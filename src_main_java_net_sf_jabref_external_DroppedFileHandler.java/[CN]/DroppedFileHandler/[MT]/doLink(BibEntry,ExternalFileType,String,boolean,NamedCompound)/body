{
  String oldValue=entry.getField(Globals.FILE_FIELD);
  FileListTableModel tm=new FileListTableModel();
  if (oldValue != null) {
    tm.setContent(oldValue);
  }
  if (avoidDuplicate) {
    List<String> dirs=panel.metaData().getFileDirectory(Globals.FILE_FIELD);
    String absFilename=!new File(filename).isAbsolute() && (dirs.size() > 0) ? FileUtil.expandFilename(filename,dirs).getAbsolutePath() : filename;
    for (int i=0; i < tm.getRowCount(); i++) {
      FileListEntry flEntry=tm.getEntry(i);
      String absName=!new File(flEntry.link).isAbsolute() && (dirs.size() > 0) ? FileUtil.expandFilename(flEntry.link,dirs).getAbsolutePath() : flEntry.link;
      System.out.println("absName: " + absName);
      if (absFilename.equals(absName)) {
        return;
      }
    }
  }
  tm.addEntry(tm.getRowCount(),new FileListEntry("",filename,fileType));
  String newValue=tm.getStringRepresentation();
  UndoableFieldChange edit=new UndoableFieldChange(entry,Globals.FILE_FIELD,oldValue,newValue);
  entry.setField(Globals.FILE_FIELD,newValue);
  if (edits == null) {
    panel.undoManager.addEdit(edit);
  }
 else {
    edits.addEdit(edit);
  }
}
