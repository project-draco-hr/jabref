{
  if (!"pdf".equals(fileType.getExtension())) {
    return false;
  }
  List<BibEntry> xmpEntriesInFile;
  try {
    xmpEntriesInFile=XMPUtil.readXMP(fileName,XMPPreferences.fromPreferences(Globals.prefs));
  }
 catch (  IOException e) {
    LOGGER.warn("Problem reading XMP",e);
    return false;
  }
  if ((xmpEntriesInFile == null) || xmpEntriesInFile.isEmpty()) {
    return false;
  }
  JLabel confirmationMessage=new JLabel(Localization.lang("The PDF contains one or several BibTeX-records.") + "\n" + Localization.lang("Do you want to import these as new entries into the current database?"));
  int reply=JOptionPane.showConfirmDialog(frame,confirmationMessage,Localization.lang("XMP-metadata found in PDF: %0",fileName),JOptionPane.YES_NO_CANCEL_OPTION,JOptionPane.QUESTION_MESSAGE);
  if (reply == JOptionPane.CANCEL_OPTION) {
    return true;
  }
  if (reply == JOptionPane.NO_OPTION) {
    return false;
  }
  boolean isSingle=xmpEntriesInFile.size() == 1;
  BibEntry single=isSingle ? xmpEntriesInFile.get(0) : null;
  boolean success=true;
  String destFilename;
  if (linkInPlace.isSelected()) {
    destFilename=FileUtil.shortenFileName(new File(fileName),panel.getBibDatabaseContext().getFileDirectory()).toString();
  }
 else {
    if (renameCheckBox.isSelected()) {
      destFilename=fileName;
    }
 else {
      destFilename=single.getCiteKey() + "." + fileType.getExtension();
    }
    if (copyRadioButton.isSelected()) {
      success=doCopy(fileName,destFilename,edits);
    }
 else     if (moveRadioButton.isSelected()) {
      success=doMove(fileName,destFilename,edits);
    }
  }
  if (success) {
    for (    BibEntry aXmpEntriesInFile : xmpEntriesInFile) {
      aXmpEntriesInFile.setId(IdGenerator.next());
      edits.addEdit(new UndoableInsertEntry(panel.getDatabase(),aXmpEntriesInFile,panel));
      panel.getDatabase().insertEntry(aXmpEntriesInFile);
      doLink(aXmpEntriesInFile,fileType,destFilename,true,edits);
    }
    panel.markBaseChanged();
    panel.updateEntryEditorIfShowing();
  }
  return true;
}
