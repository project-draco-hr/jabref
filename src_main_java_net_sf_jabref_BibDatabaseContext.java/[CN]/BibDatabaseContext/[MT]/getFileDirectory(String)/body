{
  List<String> fileDirs=new ArrayList<>();
  String key=Globals.prefs.get(JabRefPreferences.USER_FILE_DIR_INDIVIDUAL);
  List<String> metaDataDirectory=metaData.getData(key);
  if (metaDataDirectory == null || metaDataDirectory.isEmpty()) {
    if (metaData.getDefaultFileDirectory().isPresent()) {
      metaDataDirectory=Collections.singletonList(metaData.getDefaultFileDirectory().get());
    }
  }
  if ((metaDataDirectory != null) && !metaDataDirectory.isEmpty()) {
    String dir;
    dir=metaDataDirectory.get(0);
    if (!new File(dir).isAbsolute() && (getDatabaseFile() != null)) {
      String relDir;
      if (".".equals(dir)) {
        relDir=getDatabaseFile().getParent();
      }
 else {
        relDir=getDatabaseFile().getParent() + File.separator + dir;
      }
      if (new File(relDir).exists()) {
        dir=relDir;
      }
    }
    fileDirs.add(dir);
  }
 else {
    String dir=Globals.prefs.get(fieldName + Globals.DIR_SUFFIX);
    if (dir != null) {
      fileDirs.add(dir);
    }
  }
  if (getDatabaseFile() != null) {
    String parentDir=getDatabaseFile().getParent();
    if (Globals.prefs.getBoolean(JabRefPreferences.BIB_LOC_AS_PRIMARY_DIR)) {
      fileDirs.add(0,parentDir);
    }
 else {
      fileDirs.add(parentDir);
    }
  }
  return fileDirs;
}
