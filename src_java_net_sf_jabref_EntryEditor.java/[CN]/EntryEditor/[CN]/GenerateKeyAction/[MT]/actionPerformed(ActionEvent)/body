{
  try {
    Object oldValue=entry.getField(GUIGlobals.KEY_FIELD);
    LabelPatternUtil.makeLabel(prefs.getKeyPattern(),panel.database,entry);
    panel.undoManager.addEdit(new UndoableKeyChange(panel.database,entry.getId(),(String)oldValue,(String)entry.getField(GUIGlobals.KEY_FIELD)));
    String bibtexKeyData=(String)entry.getField(Globals.KEY_FIELD);
    setField(Globals.KEY_FIELD,bibtexKeyData);
    updateSource();
    panel.markBaseChanged();
  }
 catch (  Throwable t) {
    System.err.println("error setting key: " + t);
  }
}
