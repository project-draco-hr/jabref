{
  try {
    Object oldValue=entry.getField(GUIGlobals.KEY_FIELD);
    entry=frame.labelMaker.applyRule(entry,panel.database);
    panel.undoManager.addEdit(new UndoableKeyChange(panel.database,entry.getId(),(String)oldValue,(String)entry.getField(GUIGlobals.KEY_FIELD)));
    String bibtexKeyData=(String)entry.getField(Globals.KEY_FIELD);
    setField(Globals.KEY_FIELD,bibtexKeyData);
    panel.markBaseChanged();
    panel.refreshTable();
  }
 catch (  Throwable t) {
    System.err.println("error setting key: " + t);
  }
}
