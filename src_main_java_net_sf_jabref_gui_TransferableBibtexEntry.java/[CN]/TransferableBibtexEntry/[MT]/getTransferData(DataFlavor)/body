{
  if (flavor.equals(TransferableBibtexEntry.entryFlavor)) {
    return data;
  }
 else   if (flavor.equals(DataFlavor.stringFlavor)) {
    try {
      StringWriter sw=new StringWriter();
      BibEntryWriter bibtexEntryWriter=new BibEntryWriter(new LatexFieldFormatter(),false);
      for (      BibEntry entry : data) {
        bibtexEntryWriter.write(entry,sw);
      }
      return sw.toString();
    }
 catch (    IOException ex) {
      JOptionPane.showMessageDialog(null,"Could not paste entry as text:\n" + ex.getMessage(),"Clipboard",JOptionPane.ERROR_MESSAGE);
      return "";
    }
  }
 else {
    throw new UnsupportedFlavorException(flavor);
  }
}
