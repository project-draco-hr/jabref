{
  this.entry=entry;
  icon.setText(null);
  ButtonGroup bg=new ButtonGroup();
  bg.add(useDefault);
  bg.add(other);
  DefaultFormBuilder builder=new DefaultFormBuilder(new FormLayout("left:pref, 4dlu, fill:150dlu, 4dlu, fill:pref",""));
  builder.append(Globals.lang("Icon"));
  builder.append(icon);
  builder.nextLine();
  builder.append(Globals.lang("Name"));
  builder.append(name);
  builder.nextLine();
  builder.append(Globals.lang("Extension"));
  builder.append(extension);
  builder.nextLine();
  builder.append(Globals.lang("MIME type"));
  builder.append(mimeType);
  builder.getPanel().setBorder(BorderFactory.createEmptyBorder(5,5,5,5));
  builder.nextLine();
  builder.append(Globals.lang("Application"));
  JButton browseBut=new JButton(Globals.lang("Browse"));
  if (Globals.ON_WIN) {
    builder.append(useDefault);
    builder.nextLine();
    JPanel p1=new JPanel();
    builder.append(p1);
    JPanel p2=new JPanel();
    application.setPreferredSize(new Dimension(300,application.getPreferredSize().height));
    BorderLayout bl=new BorderLayout();
    bl.setHgap(4);
    p2.setLayout(bl);
    p2.add(other,BorderLayout.WEST);
    p2.add(application,BorderLayout.CENTER);
    builder.append(p2);
    builder.append(browseBut);
  }
 else {
    builder.append(application);
    builder.append(browseBut);
  }
  ButtonBarBuilder bb=new ButtonBarBuilder();
  bb.addGlue();
  bb.addGridded(ok);
  bb.addGridded(cancel);
  bb.addGlue();
  ok.addActionListener(new ActionListener(){
    public void actionPerformed(    ActionEvent e){
      okPressed=true;
      storeSettings(ExternalFileTypeEntryEditor.this.entry);
      diag.dispose();
    }
  }
);
  cancel.addActionListener(new ActionListener(){
    public void actionPerformed(    ActionEvent e){
      diag.dispose();
    }
  }
);
  icon.addActionListener(new ActionListener(){
    public void actionPerformed(    ActionEvent actionEvent){
      String initSel=ExternalFileTypeEntryEditor.this.entry.getIconName();
      if (selectedIcon != null)       initSel=selectedIcon;
      IconSelection ic=new IconSelection(diag,initSel);
      ic.setVisible(true);
      if (ic.isOkPressed()) {
        selectedIcon=ic.getSelectedIconKey();
        icon.setIcon(GUIGlobals.getImage(selectedIcon));
      }
    }
  }
);
  if (Globals.ON_WIN) {
    application.getDocument().addDocumentListener(new DocumentListener(){
      private void handle(      DocumentEvent e){
        if (application.getText().length() == 0) {
          useDefault.setSelected(true);
        }
 else {
          other.setSelected(true);
        }
      }
      public void insertUpdate(      DocumentEvent e){
        handle(e);
      }
      public void removeUpdate(      DocumentEvent documentEvent){
        handle(documentEvent);
      }
      public void changedUpdate(      DocumentEvent documentEvent){
        handle(documentEvent);
      }
    }
);
  }
  if (dParent != null)   diag=new JDialog(dParent,Globals.lang("Edit file type"),true);
 else   diag=new JDialog(fParent,Globals.lang("Edit file type"),true);
  diag.getContentPane().add(builder.getPanel(),BorderLayout.CENTER);
  diag.getContentPane().add(bb.getPanel(),BorderLayout.SOUTH);
  diag.pack();
  BrowseListener browse=new BrowseListener(diag,application);
  browseBut.addActionListener(browse);
  if (dParent != null)   diag.setLocationRelativeTo(dParent);
 else   diag.setLocationRelativeTo(fParent);
  setValues(entry);
}
