{
  Node result=null;
  try {
    Element mods=d.createElement("mods");
    mods.setAttribute("version","3.0");
    mods.setAttribute("ID",id);
    Element titleInfo=d.createElement("titleInfo");
    Element mainTitle=d.createElement("title");
    mainTitle.setNodeValue(title);
    titleInfo.appendChild(mainTitle);
    mods.appendChild(titleInfo);
    if (authors != null) {
      for (Iterator iter=authors.iterator(); iter.hasNext(); ) {
        PersonName name=(PersonName)iter.next();
        Element modsName=d.createElement("name");
        modsName.setAttribute("type","personal");
        if (name.getSurname() != null) {
          Element namePart=d.createElement("namePart");
          namePart.setAttribute("type","family");
          namePart.setNodeValue(name.getSurname());
          modsName.appendChild(namePart);
        }
        if (name.getGivenNames() != null) {
          Element namePart=d.createElement("namePart");
          namePart.setAttribute("type","given");
          namePart.setNodeValue(name.getGivenNames());
          modsName.appendChild(namePart);
        }
        Element role=d.createElement("role");
        Element roleTerm=d.createElement("roleTerm");
        roleTerm.setAttribute("type","text");
        roleTerm.setNodeValue("author");
        role.appendChild(roleTerm);
        modsName.appendChild(role);
        mods.appendChild(modsName);
      }
    }
    Element originInfo=d.createElement("originInfo");
    mods.appendChild(originInfo);
    if (this.publisher != null) {
      Element publisher=d.createElement("publisher");
      publisher.setNodeValue(this.publisher);
      originInfo.appendChild(publisher);
    }
    if (date != null) {
      Element dateIssued=d.createElement("dateIssued");
      dateIssued.setNodeValue(date);
      originInfo.appendChild(dateIssued);
    }
    Element issuance=d.createElement("issuance");
    issuance.setNodeValue(this.issuance);
    originInfo.appendChild(issuance);
    Element idref=d.createElement("identifier");
    idref.setNodeValue(id);
    mods.appendChild(idref);
    Element typeOfResource=d.createElement("typeOfResource");
    typeOfResource.setNodeValue(type);
    mods.appendChild(typeOfResource);
    if (genre != null) {
      Element genreElement=d.createElement("genre");
      genreElement.setAttribute("authority","marc");
      genreElement.setNodeValue(genre);
      mods.appendChild(genreElement);
    }
    if (host != null) {
    }
    for (Iterator iter=extensionFields.entrySet().iterator(); iter.hasNext(); ) {
      Element extension=d.createElement("extension");
      Map.Entry theEntry=(Map.Entry)iter.next();
      String field=(String)theEntry.getKey();
      String value=(String)theEntry.getValue();
      if (handledExtensions.contains(field))       continue;
      Element theData=d.createElement(field);
      theData.setNodeValue(value);
      extension.appendChild(theData);
      mods.appendChild(extension);
    }
    return mods;
  }
 catch (  Exception e) {
    System.out.println("Exception caught..." + e);
    e.printStackTrace();
  }
  return result;
}
