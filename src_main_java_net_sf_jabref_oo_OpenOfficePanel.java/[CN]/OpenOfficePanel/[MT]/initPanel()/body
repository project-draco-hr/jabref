{
  OpenOfficePanel.useDefaultAuthoryearStyle=Globals.prefs.getBoolean("ooUseDefaultAuthoryearStyle");
  OpenOfficePanel.useDefaultNumericalStyle=Globals.prefs.getBoolean("ooUseDefaultNumericalStyle");
  Action al=new AbstractAction(){
    @Override public void actionPerformed(    ActionEvent e){
      connect(true);
    }
  }
;
  OpenOfficePanel.connect.addActionListener(al);
  OpenOfficePanel.manualConnect.addActionListener(new ActionListener(){
    @Override public void actionPerformed(    ActionEvent event){
      connect(false);
    }
  }
);
  OpenOfficePanel.selectDocument.setToolTipText(Globals.lang("Select which open Writer document to work on"));
  OpenOfficePanel.selectDocument.addActionListener(new ActionListener(){
    @Override public void actionPerformed(    ActionEvent event){
      try {
        OpenOfficePanel.ooBase.selectDocument();
        OpenOfficePanel.frame.output(Globals.lang("Connected to document") + ": " + OpenOfficePanel.ooBase.getCurrentDocumentTitle());
      }
 catch (      Exception ex) {
        JOptionPane.showMessageDialog(OpenOfficePanel.frame,ex.getMessage(),Globals.lang("Error"),JOptionPane.ERROR_MESSAGE);
      }
    }
  }
);
  OpenOfficePanel.setStyleFile.addActionListener(new ActionListener(){
    @Override public void actionPerformed(    ActionEvent e){
      if (styleDialog == null) {
        styleDialog=new StyleSelectDialog(OpenOfficePanel.frame,OpenOfficePanel.styleFile);
      }
      styleDialog.setVisible(true);
      if (styleDialog.isOkPressed()) {
        OpenOfficePanel.useDefaultAuthoryearStyle=Globals.prefs.getBoolean("ooUseDefaultAuthoryearStyle");
        OpenOfficePanel.useDefaultNumericalStyle=Globals.prefs.getBoolean("ooUseDefaultNumericalStyle");
        OpenOfficePanel.styleFile=Globals.prefs.get("ooBibliographyStyleFile");
        try {
          readStyleFile();
        }
 catch (        Exception ex) {
          ex.printStackTrace();
        }
      }
    }
  }
);
  OpenOfficePanel.pushEntries.setToolTipText(Globals.lang("Cite selected entries"));
  OpenOfficePanel.pushEntries.addActionListener(new ActionListener(){
    @Override public void actionPerformed(    ActionEvent e){
      pushEntries(true,true,false);
    }
  }
);
  OpenOfficePanel.pushEntriesInt.setToolTipText(Globals.lang("Cite selected entries with in-text citation"));
  OpenOfficePanel.pushEntriesInt.addActionListener(new ActionListener(){
    @Override public void actionPerformed(    ActionEvent e){
      pushEntries(false,true,false);
    }
  }
);
  OpenOfficePanel.pushEntriesEmpty.setToolTipText(Globals.lang("Insert a citation without text (the entry will appear in the reference list)"));
  OpenOfficePanel.pushEntriesEmpty.addActionListener(new ActionListener(){
    @Override public void actionPerformed(    ActionEvent event){
      pushEntries(false,false,false);
    }
  }
);
  OpenOfficePanel.pushEntriesAdvanced.setToolTipText(Globals.lang("Cite selected entries with extra information"));
  OpenOfficePanel.pushEntriesAdvanced.addActionListener(new ActionListener(){
    @Override public void actionPerformed(    ActionEvent event){
      pushEntries(false,true,true);
    }
  }
);
  OpenOfficePanel.focus.addActionListener(new ActionListener(){
    @Override public void actionPerformed(    ActionEvent e){
      OpenOfficePanel.ooBase.setFocus();
    }
  }
);
  OpenOfficePanel.update.setToolTipText(Globals.lang("Ensure that the bibliography is up-to-date"));
  Action updateAction=new AbstractAction(){
    @Override public void actionPerformed(    ActionEvent e){
      try {
        try {
          if (OpenOfficePanel.style == null) {
            readStyleFile();
          }
 else {
            OpenOfficePanel.style.ensureUpToDate();
          }
        }
 catch (        Throwable ex) {
          JOptionPane.showMessageDialog(OpenOfficePanel.frame,Globals.lang("You must select either a valid style file, or use one of the default styles."),Globals.lang("No valid style file defined"),JOptionPane.ERROR_MESSAGE);
          return;
        }
        OpenOfficePanel.ooBase.updateSortedReferenceMarks();
        java.util.List<BibtexDatabase> databases=getBaseList();
        java.util.List<String> unresolvedKeys=OpenOfficePanel.ooBase.refreshCiteMarkers(databases,OpenOfficePanel.style);
        OpenOfficePanel.ooBase.rebuildBibTextSection(databases,OpenOfficePanel.style);
        if (unresolvedKeys.size() > 0) {
          JOptionPane.showMessageDialog(OpenOfficePanel.frame,Globals.lang("Your OpenOffice document references the BibTeX key '%0', which could not be found in your current database.",unresolvedKeys.get(0)),Globals.lang("Unable to synchronize bibliography"),JOptionPane.ERROR_MESSAGE);
        }
      }
 catch (      UndefinedCharacterFormatException ex) {
        reportUndefinedCharacterFormat(ex);
      }
catch (      UndefinedParagraphFormatException ex) {
        reportUndefinedParagraphFormat(ex);
      }
catch (      ConnectionLostException ex) {
        showConnectionLostErrorMessage();
      }
catch (      BibtexEntryNotFoundException ex) {
        JOptionPane.showMessageDialog(OpenOfficePanel.frame,Globals.lang("Your OpenOffice document references the BibTeX key '%0', which could not be found in your current database.",ex.getBibtexKey()),Globals.lang("Unable to synchronize bibliography"),JOptionPane.ERROR_MESSAGE);
      }
catch (      Exception e1) {
        e1.printStackTrace();
      }
    }
  }
;
  OpenOfficePanel.update.addActionListener(updateAction);
  OpenOfficePanel.insertFullRef.addActionListener(new ActionListener(){
    @Override public void actionPerformed(    ActionEvent event){
      try {
        insertFullRefs();
      }
 catch (      Exception e1) {
        e1.printStackTrace();
      }
    }
  }
);
  OpenOfficePanel.merge.setToolTipText(Globals.lang("Combine pairs of citations that are separated by spaces only"));
  OpenOfficePanel.merge.addActionListener(new ActionListener(){
    @Override public void actionPerformed(    ActionEvent event){
      try {
        OpenOfficePanel.ooBase.combineCiteMarkers(getBaseList(),OpenOfficePanel.style);
      }
 catch (      UndefinedCharacterFormatException e) {
        reportUndefinedCharacterFormat(e);
      }
catch (      Exception e) {
        e.printStackTrace();
      }
    }
  }
);
  OpenOfficePanel.settingsB.addActionListener(new ActionListener(){
    @Override public void actionPerformed(    ActionEvent actionEvent){
      showSettingsPopup();
    }
  }
);
  OpenOfficePanel.help.addActionListener(new HelpAction(Globals.helpDiag,"OpenOfficeIntegration.html"));
  OpenOfficePanel.manageCitations.addActionListener(new ActionListener(){
    @Override public void actionPerformed(    ActionEvent event){
      try {
        CitationManager cm=new CitationManager(OpenOfficePanel.frame,OpenOfficePanel.ooBase);
        cm.showDialog();
      }
 catch (      Exception e) {
        e.printStackTrace();
      }
    }
  }
);
  OpenOfficePanel.test.addActionListener(new ActionListener(){
    @Override public void actionPerformed(    ActionEvent event){
      try {
      }
 catch (      Exception e) {
        e.printStackTrace();
      }
    }
  }
);
  OpenOfficePanel.selectDocument.setEnabled(false);
  OpenOfficePanel.pushEntries.setEnabled(false);
  OpenOfficePanel.pushEntriesInt.setEnabled(false);
  OpenOfficePanel.pushEntriesEmpty.setEnabled(false);
  OpenOfficePanel.pushEntriesAdvanced.setEnabled(false);
  OpenOfficePanel.focus.setEnabled(false);
  OpenOfficePanel.update.setEnabled(false);
  OpenOfficePanel.insertFullRef.setEnabled(false);
  OpenOfficePanel.merge.setEnabled(false);
  OpenOfficePanel.manageCitations.setEnabled(false);
  OpenOfficePanel.test.setEnabled(false);
  diag=new JDialog((JFrame)null,"OpenOffice panel",false);
  DefaultFormBuilder b=new DefaultFormBuilder(new FormLayout("fill:pref:grow","p,p,p,p,p,p,p,p,p,p"));
  DefaultFormBuilder bb=new DefaultFormBuilder(new FormLayout("fill:pref:grow, 1dlu, fill:pref:grow, 1dlu, fill:pref:grow, " + "1dlu, fill:pref:grow, 1dlu, fill:pref:grow",""));
  bb.append(OpenOfficePanel.connect);
  bb.append(OpenOfficePanel.manualConnect);
  bb.append(OpenOfficePanel.selectDocument);
  bb.append(OpenOfficePanel.update);
  bb.append(OpenOfficePanel.help);
  b.append(bb.getPanel());
  b.append(OpenOfficePanel.setStyleFile);
  b.append(OpenOfficePanel.pushEntries);
  b.append(OpenOfficePanel.pushEntriesInt);
  b.append(OpenOfficePanel.pushEntriesAdvanced);
  b.append(OpenOfficePanel.pushEntriesEmpty);
  b.append(OpenOfficePanel.merge);
  b.append(OpenOfficePanel.manageCitations);
  b.append(OpenOfficePanel.settingsB);
  JPanel content=new JPanel();
  comp.setContent(content);
  content.setLayout(new BorderLayout());
  content.add(b.getPanel(),BorderLayout.CENTER);
  OpenOfficePanel.frame.getTabbedPane().getInputMap(JComponent.WHEN_IN_FOCUSED_WINDOW).put(Globals.prefs.getKey("Refresh OO"),"Refresh OO");
  OpenOfficePanel.frame.getTabbedPane().getActionMap().put("Refresh OO",updateAction);
}
