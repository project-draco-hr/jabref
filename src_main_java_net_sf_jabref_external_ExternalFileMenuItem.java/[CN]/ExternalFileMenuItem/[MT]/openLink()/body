{
  frame.output(Localization.lang("External viewer called") + ".");
  try {
    ExternalFileType type=fileType;
    if (this.fileType == null) {
      if (this.fieldName != null) {
        JabRefDesktop.openExternalViewer(frame.basePanel().metaData(),link,fieldName);
        return true;
      }
 else {
        File file=new File(link);
        String name=file.getName();
        int pos=name.indexOf('.');
        String extension=pos >= 0 && pos < name.length() - 1 ? name.substring(pos + 1).trim().toLowerCase() : null;
        type=Globals.prefs.getExternalFileTypeByExt(extension);
        fileType=type;
      }
    }
    if (type instanceof UnknownExternalFileType) {
      return JabRefDesktop.openExternalFileUnknown(frame,entry,metaData,link,(UnknownExternalFileType)type);
    }
 else {
      return JabRefDesktop.openExternalFileAnyFormat(metaData,link,type);
    }
  }
 catch (  IOException e1) {
    if (fileType != null && fileType.getOpenWith() != null && !fileType.getOpenWith().isEmpty() && e1.getMessage().contains(fileType.getOpenWith())) {
      JOptionPane.showMessageDialog(frame,Localization.lang("Unable to open link. " + "The application '%0' associated with the file type '%1' could not be called.",fileType.getOpenWith(),fileType.getName()),Localization.lang("Could not open link"),JOptionPane.ERROR_MESSAGE);
      return false;
    }
    e1.printStackTrace();
  }
  return false;
}
