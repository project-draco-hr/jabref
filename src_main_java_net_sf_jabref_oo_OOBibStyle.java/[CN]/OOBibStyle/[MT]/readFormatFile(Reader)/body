{
  StringBuffer sb=new StringBuffer();
  int c;
  while ((c=in.read()) != -1) {
    sb.append((char)c);
  }
  String[] lines=sb.toString().split("\n");
  int mode=OOBibStyle.NONE;
  for (  String line1 : lines) {
    String line=line1;
    if ((!line.isEmpty()) && (line.charAt(line.length() - 1) == '\r')) {
      line=line.substring(0,line.length() - 1);
    }
    if ((line.trim().isEmpty()) || (line.charAt(0) == '#')) {
      continue;
    }
    if (line.equals(OOBibStyle.NAME_MARK)) {
      mode=OOBibStyle.NAME;
      continue;
    }
 else     if (line.equals(OOBibStyle.LAYOUT_MRK)) {
      mode=OOBibStyle.LAYOUT;
      continue;
    }
 else     if (line.equals(OOBibStyle.PROPERTIES_MARK)) {
      mode=OOBibStyle.PROPERTIES;
      continue;
    }
 else     if (line.equals(OOBibStyle.CITATION_MARK)) {
      mode=OOBibStyle.CITATION;
      continue;
    }
 else     if (line.equals(OOBibStyle.JOURNALS_MARK)) {
      mode=OOBibStyle.JOURNALS;
      continue;
    }
switch (mode) {
case NAME:
      if (!line.trim().isEmpty()) {
        name=line.trim();
      }
case LAYOUT:
    handleStructureLine(line);
  break;
case PROPERTIES:
handlePropertiesLine(line,properties);
break;
case CITATION:
handlePropertiesLine(line,citProperties);
break;
case JOURNALS:
handleJournalsLine(line);
}
}
if (mode != OOBibStyle.NONE) {
valid=true;
}
}
