{
  StringBuilder sb=new StringBuilder();
  int c;
  while ((c=in.read()) != -1) {
    sb.append((char)c);
  }
  String[] lines=sb.toString().split("\n");
  int mode=OOBibStyle.MODE_NONE;
  for (  String line1 : lines) {
    String line=line1;
    if (!line.isEmpty() && (line.charAt(line.length() - 1) == '\r')) {
      line=line.substring(0,line.length() - 1);
    }
    if (line.trim().isEmpty() || (line.charAt(0) == '#')) {
      continue;
    }
    if (line.equals(OOBibStyle.NAME_MARK)) {
      mode=OOBibStyle.MODE_NAME;
      continue;
    }
 else     if (line.equals(OOBibStyle.LAYOUT_MRK)) {
      mode=OOBibStyle.MODE_LAYOUT;
      continue;
    }
 else     if (line.equals(OOBibStyle.PROPERTIES_MARK)) {
      mode=OOBibStyle.MODE_PROPERTIES;
      continue;
    }
 else     if (line.equals(OOBibStyle.CITATION_MARK)) {
      mode=OOBibStyle.MODE_CITATION;
      continue;
    }
 else     if (line.equals(OOBibStyle.JOURNALS_MARK)) {
      mode=OOBibStyle.MODE_JOURNALS;
      continue;
    }
switch (mode) {
case MODE_NAME:
      if (!line.trim().isEmpty()) {
        name=line.trim();
      }
    break;
case MODE_LAYOUT:
  handleStructureLine(line);
break;
case MODE_PROPERTIES:
handlePropertiesLine(line,properties);
break;
case MODE_CITATION:
handlePropertiesLine(line,citProperties);
break;
case MODE_JOURNALS:
handleJournalsLine(line);
break;
default :
break;
}
}
if (mode != OOBibStyle.MODE_NONE) {
valid=true;
}
}
