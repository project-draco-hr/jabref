{
  String authorField=(String)citProperties.get(AUTHOR_FIELD);
  int maxA=(Integer)citProperties.get(MAX_AUTHORS);
  String etAlString=(String)citProperties.get(ET_AL_STRING);
  String yearSep=(String)citProperties.get(IN_TEXT_YEAR_SEPARATOR);
  String startBrace=(String)citProperties.get(BRACKET_BEFORE);
  String endBrace=(String)citProperties.get(BRACKET_AFTER);
  String citationSeparator=(String)citProperties.get(CITATION_SEPARATOR);
  String yearField=(String)citProperties.get(YEAR_FIELD);
  String authorSep=(String)citProperties.get(AUTHOR_SEPARATOR);
  String andString=(String)citProperties.get(AUTHOR_LAST_SEPARATOR_IN_TEXT);
  if (andString == null) {
    andString=(String)citProperties.get(AUTHOR_LAST_SEPARATOR);
  }
  StringBuilder sb=new StringBuilder();
  for (int i=0; i < entries.size(); i++) {
    int unlimA=unlimAuthors == null ? -1 : unlimAuthors[i];
    int maxAuthors=unlimA > 0 ? unlimA : maxA;
    if (entries.get(i) == null) {
      continue;
    }
    if (i > 0) {
      sb.append(citationSeparator);
    }
    String author=getCitationMarkerField(entries.get(i),database.get(entries.get(i)),authorField);
    String authorString=createAuthorList(author,maxAuthors,authorSep,andString,etAlString,yearSep);
    sb.append(authorString);
    sb.append(startBrace);
    String year=getCitationMarkerField(entries.get(i),database.get(entries.get(i)),yearField);
    if (year != null) {
      sb.append(year);
    }
    if ((uniquefiers != null) && (uniquefiers[i] != null)) {
      sb.append(uniquefiers[i]);
    }
    sb.append(endBrace);
  }
  return sb.toString();
}
