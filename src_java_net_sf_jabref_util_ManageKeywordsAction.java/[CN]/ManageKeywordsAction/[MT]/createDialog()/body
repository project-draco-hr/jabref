{
  keyword=new JTextField();
  keywordListModel=new DefaultListModel<String>();
  keywordList=new JList<String>(keywordListModel);
  kPane=new JScrollPane(keywordList);
  diag=new JDialog(frame,Globals.lang("Manage keywords"),true);
  ok=new JButton(Globals.lang("Ok"));
  cancel=new JButton(Globals.lang("Cancel"));
  add=new JButton(Globals.lang("Add"));
  remove=new JButton(Globals.lang("Remove"));
  keywordList.setVisibleRowCount(10);
  DefaultFormBuilder builder=new DefaultFormBuilder(new FormLayout("fill:100dlu, 8dlu, left:pref, 8dlu, left:pref",""));
  builder.appendSeparator(Globals.lang("Common keywords of selected entries"));
  builder.append(kPane,3);
  builder.add(remove);
  builder.nextLine();
  builder.append(keyword,3);
  builder.append(add);
  builder.nextLine();
  ButtonBarBuilder2 bb=new ButtonBarBuilder2();
  bb.addGlue();
  bb.addButton(ok);
  bb.addGlue();
  bb.addButton(cancel);
  bb.addGlue();
  builder.getPanel().setBorder(BorderFactory.createEmptyBorder(5,5,5,5));
  bb.getPanel().setBorder(BorderFactory.createEmptyBorder(5,5,5,5));
  diag.getContentPane().add(builder.getPanel(),BorderLayout.CENTER);
  diag.getContentPane().add(bb.getPanel(),BorderLayout.SOUTH);
  diag.pack();
  ok.addActionListener(new ActionListener(){
    public void actionPerformed(    ActionEvent e){
      cancelled=false;
      diag.dispose();
    }
  }
);
  AbstractAction cancelAction=new AbstractAction(){
    public void actionPerformed(    ActionEvent e){
      cancelled=true;
      diag.dispose();
    }
  }
;
  cancel.addActionListener(cancelAction);
  final ActionListener addActionListener=new ActionListener(){
    @Override public void actionPerformed(    ActionEvent arg0){
      String text=keyword.getText().trim();
      if (text.equals("")) {
        return;
      }
      if (keywordListModel.isEmpty()) {
        keywordListModel.addElement(text);
      }
 else {
        int idx=0;
        while ((idx < keywordListModel.size()) && (keywordListModel.getElementAt(idx).compareTo(text) < 0)) {
          idx++;
        }
        if (idx == keywordListModel.size()) {
          keywordListModel.addElement(text);
        }
 else         if (keywordListModel.getElementAt(idx).compareTo(text) == 0) {
        }
 else {
          keywordListModel.add(idx,text);
        }
      }
      keyword.setText(null);
      keyword.requestFocusInWindow();
    }
  }
;
  add.addActionListener(addActionListener);
  final ActionListener removeActionListenter=new ActionListener(){
    @Override public void actionPerformed(    ActionEvent arg0){
      List<String> selectedValuesList=keywordList.getSelectedValuesList();
      for (      String val : selectedValuesList) {
        keywordListModel.removeElement(val);
      }
    }
  }
;
  remove.addActionListener(removeActionListenter);
  keywordList.addKeyListener(new KeyListener(){
    @Override public void keyTyped(    KeyEvent arg0){
    }
    @Override public void keyReleased(    KeyEvent arg0){
    }
    @Override public void keyPressed(    KeyEvent arg0){
      if (arg0.getKeyCode() == KeyEvent.VK_DELETE) {
        removeActionListenter.actionPerformed(null);
      }
    }
  }
);
  AbstractAutoCompleter autoComp=JabRef.jrf.basePanel().getAutoCompleter("keywords");
  AutoCompleteListener acl=new AutoCompleteListener(autoComp);
  keyword.addKeyListener(acl);
  keyword.addFocusListener(acl);
  keyword.addKeyListener(new KeyListener(){
    @Override public void keyTyped(    KeyEvent e){
    }
    @Override public void keyReleased(    KeyEvent e){
    }
    @Override public void keyPressed(    KeyEvent e){
      if (e.getKeyCode() == KeyEvent.VK_ENTER) {
        addActionListener.actionPerformed(null);
      }
    }
  }
);
  ActionMap am=builder.getPanel().getActionMap();
  InputMap im=builder.getPanel().getInputMap(JComponent.WHEN_IN_FOCUSED_WINDOW);
  im.put(Globals.prefs.getKey("Close dialog"),"close");
  am.put("close",cancelAction);
}
