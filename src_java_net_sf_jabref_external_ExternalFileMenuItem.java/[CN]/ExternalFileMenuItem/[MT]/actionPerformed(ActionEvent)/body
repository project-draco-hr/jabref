{
  try {
    ExternalFileType type=fileType;
    if (this.fileType == null) {
      File file=new File(link);
      String name=file.getName();
      int pos=name.indexOf('.');
      String extension=((pos >= 0) && (pos < name.length() - 1)) ? name.substring(pos + 1).trim().toLowerCase() : null;
      type=Globals.prefs.getExternalFileTypeByExt(extension);
    }
    if (type instanceof UnknownExternalFileType)     Util.openExternalFileUnknown(frame,entry,metaData,link,(UnknownExternalFileType)type);
 else     Util.openExternalFileAnyFormat(metaData,link,type);
  }
 catch (  IOException e1) {
    e1.printStackTrace();
  }
}
