{
  int longestFound=-1;
  ExternalFileType foundType=null;
  for (Iterator<ExternalFileType> iterator=externalFileTypes.iterator(); iterator.hasNext(); ) {
    ExternalFileType type=iterator.next();
    if ((type.getExtension() != null) && filename.toLowerCase().endsWith(type.getExtension().toLowerCase())) {
      if (type.getExtension().length() > longestFound) {
        longestFound=type.getExtension().length();
        foundType=type;
      }
    }
  }
  return foundType;
}
