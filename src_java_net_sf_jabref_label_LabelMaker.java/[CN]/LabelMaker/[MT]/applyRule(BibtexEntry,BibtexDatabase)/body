{
  String newKey="";
  if (ruleTable.containsKey(newEntry.getType().getName())) {
    newKey=((LabelRule)ruleTable.get(newEntry.getType().getName())).applyRule(newEntry);
  }
 else {
    newKey=applyDefaultRule(newEntry);
  }
  newKey=Util.checkLegalKey(newKey);
  if (base.setCiteKeyForEntry(newEntry.getId(),newKey)) {
    char c='b';
    String modKey=newKey + "a";
    while (base.setCiteKeyForEntry(newEntry.getId(),modKey))     modKey=newKey + ((char)(c++));
  }
  return newEntry;
}
