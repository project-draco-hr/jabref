{
  final JDialog diag=new JDialog(frame,Globals.lang("Settings"),true);
  options.setBorder(BorderFactory.createEmptyBorder(5,5,5,5));
  diag.getContentPane().add(options,BorderLayout.CENTER);
  ButtonBarBuilder bb=new ButtonBarBuilder();
  JButton ok=new JButton(Globals.lang("Ok"));
  JButton cancel=new JButton(Globals.lang("Cancel"));
  bb.addGlue();
  bb.addGridded(ok);
  bb.addGridded(cancel);
  bb.addGlue();
  bb.getPanel().setBorder(BorderFactory.createEmptyBorder(5,5,5,5));
  diag.getContentPane().add(bb.getPanel(),BorderLayout.SOUTH);
  ok.addActionListener(new ActionListener(){
    public void actionPerformed(    ActionEvent event){
      settingsOkPressed=true;
      diag.dispose();
    }
  }
);
  cancel.addActionListener(new ActionListener(){
    public void actionPerformed(    ActionEvent event){
      diag.dispose();
    }
  }
);
  ActionMap am=bb.getPanel().getActionMap();
  InputMap im=bb.getPanel().getInputMap(JComponent.WHEN_IN_FOCUSED_WINDOW);
  im.put(Globals.prefs.getKey("Close dialog"),"close");
  am.put("close",new AbstractAction(){
    public void actionPerformed(    ActionEvent e){
      diag.dispose();
    }
  }
);
  settingsOkPressed=false;
  diag.pack();
  diag.setLocationRelativeTo(frame);
  diag.setVisible(true);
  if (settingsOkPressed) {
    toApp.storeSettings();
  }
}
