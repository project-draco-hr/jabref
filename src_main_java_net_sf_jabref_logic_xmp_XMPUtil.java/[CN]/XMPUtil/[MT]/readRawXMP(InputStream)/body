{
  try (PDDocument document=PDDocument.load(inputStream)){
    if (document.isEncrypted()) {
      throw new EncryptionNotSupportedException("Error: Cannot read metadata from encrypted document.");
    }
    return XMPUtil.getXMPMetadata(document);
  }
 }
