{
  EventList<NameAndVersion> plugins=new BasicEventList<NameAndVersion>();
  if (!PluginCore.userPluginDir.exists())   return plugins;
  String[] files=PluginCore.userPluginDir.list(new FilenameFilter(){
    public boolean accept(    File dir,    String name){
      return name.endsWith(".jar");
    }
  }
);
  HashMap<String,PluginDescriptor> urls=new HashMap<String,PluginDescriptor>();
  Collection<PluginDescriptor> descriptors=PluginCore.getManager().getRegistry().getPluginDescriptors();
  for (  PluginDescriptor desc : descriptors) {
    urls.put(desc.getLocation().getFile(),desc);
  }
  for (int i=0; i < files.length; i++) {
    String[] nav=getNameAndVersion(files[i]);
    if (nav != null) {
      VersionNumber vn=nav[1] != null ? new VersionNumber(nav[1]) : null;
      NameAndVersion nameAndVersion=new NameAndVersion(nav[0],vn);
      for (      String loc : urls.keySet()) {
        if (loc.indexOf(nav[0]) >= 0) {
          if (!PluginCore.getManager().isPluginEnabled(urls.get(loc)))           nameAndVersion.setStatus(BAD);
 else           nameAndVersion.setStatus(LOADED);
        }
      }
      plugins.add(nameAndVersion);
    }
  }
  return plugins;
}
