{
  String firstNamePart=a.getFirst();
  if (abbreviate) {
    firstNamePart=a.getFirstAbbr();
    if (firstInitialOnly && (firstNamePart.length() > 2))     firstNamePart=firstNamePart.substring(0,2);
 else     if (middleInitial) {
      String abbr=firstNamePart;
      firstNamePart=a.getFirst();
      int index=firstNamePart.indexOf(" ");
      if (index >= 0) {
        firstNamePart=firstNamePart.substring(0,index + 1);
        if (abbr.length() > 3) {
          firstNamePart=firstNamePart + abbr.substring(3);
        }
      }
    }
    if (!abbrDots)     firstNamePart=firstNamePart.replaceAll("\\.","");
    if (!abbrSpaces)     firstNamePart=firstNamePart.replaceAll(" ","");
  }
  String von=a.getVon();
  if (lastNameOnly) {
    if ((von != null) && (von.length() > 0))     sb.append(von).append(" ");
    sb.append(a.getLast());
  }
 else   if (firstFirst) {
    sb.append(firstNamePart).append(firstFirstSeparator);
    if ((von != null) && (von.length() > 0))     sb.append(von).append(" ");
    sb.append(a.getLast());
  }
 else {
    if ((von != null) && (von.length() > 0))     sb.append(von).append(" ");
    sb.append(a.getLast()).append(lastFirstSeparator).append(firstNamePart);
  }
}
