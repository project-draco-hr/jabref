{
  PDDocument document=null;
  try {
    document=PDDocument.load(tempFile.getAbsoluteFile());
    if (document.isEncrypted()) {
      System.err.println("Error: Cannot add metadata to encrypted document.");
    }
    PDDocumentCatalog catalog=document.getDocumentCatalog();
    PDMetadata meta=catalog.getMetadata();
    if (meta == null) {
      return null;
    }
 else {
      InputStreamReader is=new InputStreamReader(meta.createInputStream(),"UTF8");
      return XMPUtilTest.slurp(is).trim();
    }
  }
  finally {
    if (document != null) {
      document.close();
    }
  }
}
