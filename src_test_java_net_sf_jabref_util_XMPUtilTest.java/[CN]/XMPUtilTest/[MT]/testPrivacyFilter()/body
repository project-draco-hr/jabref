{
{
    BibEntry e=t1BibtexEntry();
    prefs.putBoolean("useXmpPrivacyFilter",true);
    prefs.putStringList(JabRefPreferences.XMP_PRIVACY_FILTERS,Arrays.asList("author","title","note"));
    XMPUtil.writeXMP(pdfFile,e,null);
    List<BibEntry> l=XMPUtil.readXMP(pdfFile.getAbsoluteFile());
    Assert.assertEquals(1,l.size());
    BibEntry x=l.get(0);
    Set<String> expectedFields=new HashSet<>(Arrays.asList("bibtexkey","booktitle","owner","timestamp","url","year"));
    Assert.assertEquals(expectedFields,x.getFieldNames());
  }
  prefs.putBoolean("useXmpPrivacyFilter",true);
  prefs.putStringList(JabRefPreferences.XMP_PRIVACY_FILTERS,Arrays.asList("author;title;note;booktitle;year;owner;timestamp"));
  BibEntry e=t1BibtexEntry();
  XMPUtil.writeXMP(pdfFile,e,null);
  List<BibEntry> l=XMPUtil.readXMP(pdfFile.getAbsoluteFile());
  Assert.assertEquals(1,l.size());
  BibEntry x=l.get(0);
  Set<String> ts=x.getFieldNames();
  Assert.assertEquals(8,ts.size());
  ts.contains("bibtextype");
  ts.contains("bibtexkey");
  ts.contains("year");
  ts.contains("url");
}
