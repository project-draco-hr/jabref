{
  diag=new JDialog(panel.frame(),Globals.lang("Duplicate BibTeX key"),true);
  DefaultFormBuilder b=new DefaultFormBuilder(new FormLayout("left:pref, 4dlu, fill:pref",""));
  b.append(new JLabel(Globals.lang("Duplicate key") + ": " + key),3);
  b.nextLine();
  b.getPanel().setBorder(BorderFactory.createEmptyBorder(5,5,5,5));
  boolean first=true;
  for (  BibtexEntry entry : entries) {
    JCheckBox cb=new JCheckBox(Globals.lang("Generate key"),!first);
    b.append(cb);
    PreviewPanel pp=new PreviewPanel(null,entry,null,new MetaData(),ResolveDuplicateLabelDialog.layout);
    pp.setPreferredSize(new Dimension(800,90));
    b.append(new JScrollPane(pp));
    b.nextLine();
    cbs.add(cb);
    first=false;
  }
  ButtonBarBuilder bb=new ButtonBarBuilder();
  bb.addGlue();
  JButton ok=new JButton(Globals.lang("Ok"));
  bb.addButton(ok);
  JButton cancel=new JButton(Globals.lang("Cancel"));
  bb.addButton(cancel);
  bb.addGlue();
  bb.getPanel().setBorder(BorderFactory.createEmptyBorder(5,5,5,5));
  diag.getContentPane().add(b.getPanel(),BorderLayout.CENTER);
  diag.getContentPane().add(bb.getPanel(),BorderLayout.SOUTH);
  diag.pack();
  ok.addActionListener(new ActionListener(){
    @Override public void actionPerformed(    ActionEvent actionEvent){
      okPressed=true;
      diag.dispose();
    }
  }
);
  cancel.addActionListener(new ActionListener(){
    @Override public void actionPerformed(    ActionEvent actionEvent){
      diag.dispose();
    }
  }
);
  AbstractAction closeAction=new AbstractAction(){
    @Override public void actionPerformed(    ActionEvent e){
      diag.dispose();
    }
  }
;
  ActionMap am=b.getPanel().getActionMap();
  InputMap im=b.getPanel().getInputMap(JComponent.WHEN_IN_FOCUSED_WINDOW);
  im.put(Globals.prefs.getKey("Close dialog"),"close");
  am.put("close",closeAction);
}
