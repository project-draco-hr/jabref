{
  diag=new JDialog(panel.frame(),Localization.lang("Duplicate BibTeX key"),true);
  FormBuilder b=FormBuilder.create().layout(new FormLayout("left:pref, 4dlu, fill:pref","p"));
  b.add(new JLabel(Localization.lang("Duplicate key") + ": " + key)).xyw(1,1,3);
  b.getPanel().setBorder(BorderFactory.createEmptyBorder(5,5,5,5));
  boolean first=true;
  int row=3;
  for (  BibtexEntry entry : entries) {
    JCheckBox cb=new JCheckBox(Localization.lang("Generate key"),!first);
    b.appendRows("1dlu, p");
    b.add(cb).xy(1,row);
    PreviewPanel pp=new PreviewPanel(null,entry,null,new MetaData(),ResolveDuplicateLabelDialog.layout);
    pp.setPreferredSize(new Dimension(800,90));
    b.add(new JScrollPane(pp)).xy(3,row);
    row+=2;
    cbs.add(cb);
    first=false;
  }
  ButtonBarBuilder bb=new ButtonBarBuilder();
  bb.addGlue();
  JButton ok=new JButton(Localization.lang("OK"));
  bb.addButton(ok);
  JButton cancel=new JButton(Localization.lang("Cancel"));
  bb.addButton(cancel);
  bb.addGlue();
  bb.getPanel().setBorder(BorderFactory.createEmptyBorder(5,5,5,5));
  diag.getContentPane().add(b.getPanel(),BorderLayout.CENTER);
  diag.getContentPane().add(bb.getPanel(),BorderLayout.SOUTH);
  diag.pack();
  ok.addActionListener(new ActionListener(){
    @Override public void actionPerformed(    ActionEvent actionEvent){
      okPressed=true;
      diag.dispose();
    }
  }
);
  cancel.addActionListener(new ActionListener(){
    @Override public void actionPerformed(    ActionEvent actionEvent){
      diag.dispose();
    }
  }
);
  AbstractAction closeAction=new AbstractAction(){
    @Override public void actionPerformed(    ActionEvent e){
      diag.dispose();
    }
  }
;
  ActionMap am=b.getPanel().getActionMap();
  InputMap im=b.getPanel().getInputMap(JComponent.WHEN_IN_FOCUSED_WINDOW);
  im.put(Globals.getKeyPrefs().getKey(KeyBinding.CLOSE_DIALOG),"close");
  am.put("close",closeAction);
}
