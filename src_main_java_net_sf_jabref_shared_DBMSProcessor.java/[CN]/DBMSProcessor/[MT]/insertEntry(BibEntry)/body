{
  try {
    int sharedID=bibEntry.getSharedBibEntryData().getSharedID();
    if (sharedID != -1) {
      StringBuilder selectQuery=new StringBuilder().append("SELECT * FROM ").append(escape("ENTRY")).append(" WHERE ").append(escape("SHARED_ID")).append(" = ?");
      try (PreparedStatement preparedSelectStatement=connection.prepareStatement(selectQuery.toString())){
        preparedSelectStatement.setInt(1,sharedID);
        try (ResultSet resultSet=preparedSelectStatement.executeQuery()){
          if (resultSet.next()) {
            return;
          }
        }
       }
     }
    StringBuilder insertIntoEntryQuery=new StringBuilder().append("INSERT INTO ").append(escape("ENTRY")).append("(").append(escape("TYPE")).append(") VALUES(?)");
    try (PreparedStatement preparedEntryStatement=connection.prepareStatement(insertIntoEntryQuery.toString(),new String[]{"SHARED_ID"})){
      preparedEntryStatement.setString(1,bibEntry.getType());
      preparedEntryStatement.executeUpdate();
      try (ResultSet generatedKeys=preparedEntryStatement.getGeneratedKeys()){
        if (generatedKeys.next()) {
          bibEntry.getSharedBibEntryData().setSharedID(generatedKeys.getInt(1));
        }
      }
       for (      String fieldName : bibEntry.getFieldNames()) {
        StringBuilder insertFieldQuery=new StringBuilder().append("INSERT INTO ").append(escape("FIELD")).append("(").append(escape("ENTRY_SHARED_ID")).append(", ").append(escape("NAME")).append(", ").append(escape("VALUE")).append(") VALUES(?, ?, ?)");
        try (PreparedStatement preparedFieldStatement=connection.prepareStatement(insertFieldQuery.toString())){
          preparedFieldStatement.setInt(1,bibEntry.getSharedBibEntryData().getSharedID());
          preparedFieldStatement.setString(2,fieldName);
          preparedFieldStatement.setString(3,bibEntry.getField(fieldName).get());
          preparedFieldStatement.executeUpdate();
        }
       }
    }
   }
 catch (  SQLException e) {
    LOGGER.error("SQL Error: ",e);
  }
}
