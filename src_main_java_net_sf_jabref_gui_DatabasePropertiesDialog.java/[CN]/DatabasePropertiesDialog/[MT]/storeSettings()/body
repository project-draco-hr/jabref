{
  SaveOrderConfig newSaveOrderConfig;
  if (saveAsConfiguredGlobally.isSelected()) {
    metaData.remove(DatabasePropertiesDialog.SAVE_ORDER_CONFIG);
    newSaveOrderConfig=null;
  }
 else {
    SaveOrderConfig saveOrderConfig=new SaveOrderConfig();
    newSaveOrderConfig=saveOrderConfig;
    if (saveInOriginalOrder.isSelected()) {
      saveOrderConfig.setSaveInOriginalOrder();
    }
 else {
      saveOrderConfig.setSaveInSpecifiedOrder();
    }
    saveOrderConfig.sortCriteria[0].field=savePriField.getText();
    saveOrderConfig.sortCriteria[0].descending=savePriDesc.isSelected();
    saveOrderConfig.sortCriteria[1].field=saveSecField.getText();
    saveOrderConfig.sortCriteria[1].descending=saveSecDesc.isSelected();
    saveOrderConfig.sortCriteria[2].field=saveTerField.getText();
    saveOrderConfig.sortCriteria[2].descending=saveTerDesc.isSelected();
    Vector<String> serialized=saveOrderConfig.getVector();
    metaData.putData(DatabasePropertiesDialog.SAVE_ORDER_CONFIG,serialized);
  }
  String oldEncoding=panel.getEncoding();
  String newEncoding=(String)encoding.getSelectedItem();
  panel.setEncoding(newEncoding);
  Vector<String> dir=new Vector<String>(1);
  String text=fileDir.getText().trim();
  if (!text.isEmpty()) {
    dir.add(text);
    metaData.putData(Globals.prefs.get(JabRefPreferences.USER_FILE_DIR),dir);
  }
 else {
    metaData.remove(Globals.prefs.get(JabRefPreferences.USER_FILE_DIR));
  }
  dir=new Vector<String>(1);
  text=fileDirIndv.getText().trim();
  if (!text.isEmpty()) {
    dir.add(text);
    metaData.putData(Globals.prefs.get(JabRefPreferences.USER_FILE_DIR_INDIVIDUAL),dir);
  }
 else {
    metaData.remove(Globals.prefs.get(JabRefPreferences.USER_FILE_DIR_INDIVIDUAL));
  }
  dir=new Vector<String>(1);
  text=pdfDir.getText().trim();
  if (!text.isEmpty()) {
    dir.add(text);
    metaData.putData("pdfDirectory",dir);
  }
 else {
    metaData.remove("pdfDirectory");
  }
  dir=new Vector<String>(1);
  text=psDir.getText().trim();
  if (!text.isEmpty()) {
    dir.add(text);
    metaData.putData("psDirectory",dir);
  }
 else {
    metaData.remove("psDirectory");
  }
  if (protect.isSelected()) {
    dir=new Vector<String>(1);
    dir.add("true");
    metaData.putData(Globals.PROTECTED_FLAG_META,dir);
  }
 else {
    metaData.remove(Globals.PROTECTED_FLAG_META);
  }
  boolean saveOrderConfigChanged;
  if (oldSaveOrderConfig == newSaveOrderConfig) {
    saveOrderConfigChanged=false;
  }
 else   if ((oldSaveOrderConfig == null) || (newSaveOrderConfig == null)) {
    saveOrderConfigChanged=true;
  }
 else {
    saveOrderConfigChanged=!oldSaveOrderConfig.getVector().equals(newSaveOrderConfig.getVector());
  }
  boolean changed=saveOrderConfigChanged || !newEncoding.equals(oldEncoding) || !oldFileVal.equals(fileDir.getText())|| !oldFileIndvVal.equals(fileDirIndv.getText())|| !oldPdfVal.equals(pdfDir.getText())|| !oldPsVal.equals(psDir.getText())|| (oldProtectVal != protect.isSelected());
  if (changed) {
    panel.markNonUndoableBaseChanged();
  }
}
