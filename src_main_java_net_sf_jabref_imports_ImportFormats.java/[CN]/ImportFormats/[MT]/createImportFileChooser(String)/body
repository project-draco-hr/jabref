{
  SortedSet<ImportFormat> importers=Globals.importFormatReader.getImportFormats();
  String lastUsedFormat=Globals.prefs.get("lastUsedImport");
  FileFilter defaultFilter=null;
  JFileChooser fc=new JFileChooser(currentDir);
  TreeSet<ImportFileFilter> filters=new TreeSet<ImportFileFilter>();
  for (  ImportFormat format : importers) {
    ImportFileFilter filter=new ImportFileFilter(format);
    filters.add(filter);
    if (format.getFormatName().equals(lastUsedFormat))     defaultFilter=filter;
  }
  for (  ImportFileFilter filter : filters) {
    fc.addChoosableFileFilter(filter);
  }
  if (defaultFilter != null)   fc.setFileFilter(defaultFilter);
 else   fc.setFileFilter(fc.getAcceptAllFileFilter());
  return fc;
}
